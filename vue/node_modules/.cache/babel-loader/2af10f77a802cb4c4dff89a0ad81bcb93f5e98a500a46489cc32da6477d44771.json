{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport vClickOutside from 'click-outside-vue3';\nimport InputText from 'primevue/inputtext';\nimport ExamPopup from '@/views/user/components/ExamPopup.vue';\nimport ExamSetup from '@/views/user/components/ExamSetup.vue';\nimport DataTable from 'primevue/datatable';\nimport Menu from 'primevue/menu';\nimport Auth from \"../../../api/utils/auth\";\nimport Dialog from 'primevue/dialog';\nimport Column from 'primevue/column';\nimport InputNumber from 'primevue/inputnumber';\nimport Dropdown from 'primevue/dropdown';\nimport Skeleton from 'primevue/skeleton';\nimport { generateCode } from '@/common/functions';\nimport Resumable from 'resumablejs';\nimport TheLoadingProgress from '@/components/LoadingProgress.vue';\nimport Button from 'primevue/button';\nimport { deleteExamBank, getExamBank, insertExamBank, updateExamBank } from '/api/exam-bank';\nimport { MESSAGE, RESPONSE_STATUS } from \"@/common/enums\";\nexport default {\n  directives: {\n    clickOutside: vClickOutside.directive\n  },\n  components: {\n    ExamPopup,\n    ExamSetup,\n    DataTable,\n    Menu,\n    Column,\n    Button,\n    Dropdown,\n    InputText,\n    Dialog,\n    InputNumber,\n    TheLoadingProgress,\n    Skeleton\n  },\n  data() {\n    return {\n      search: null,\n      selectedData: {\n        id: null,\n        exam_bank_code: null,\n        exam_bank_name: null,\n        file_size: null,\n        file_name: null\n      },\n      objSelectedData: {},\n      objFileSelected: null,\n      isLoadingDelete: false,\n      popupLoading: false,\n      warningVisible: false,\n      file: {\n        fileName: null,\n        fileSize: null,\n        success: true\n      },\n      actionItems: [{\n        label: 'Thiết lập đề',\n        icon: 'pi pi-refresh',\n        command: () => {\n          this.activeMenuItem(1);\n        }\n      }, {\n        label: 'Xóa',\n        icon: 'pi pi-upload',\n        command: () => {\n          this.activeMenuItem(2);\n        }\n      }],\n      defaultData: {\n        id: null,\n        exam_bank_code: null,\n        exam_bank_name: null\n      },\n      resumable: null,\n      invalidData: {\n        exam_bank_code: null,\n        exam_bank_name: null,\n        SheetIndexReference: null,\n        RowReference: null,\n        fileData: null\n      },\n      modeModal: this.FormMode.INSERT,\n      modeGenerate: true,\n      examBankData: [],\n      isShowModal: false,\n      isShowActions: false,\n      isLoading: false,\n      isPopupDelete: false,\n      objectLoading: {},\n      top: 0,\n      left: 0,\n      isconfigureExam: false\n    };\n  },\n  methods: {\n    /**\r\n     * Ẩn / hiện model thêm mới\r\n     */\n    showModal() {\n      this.isShowModal = !this.isShowModal;\n    },\n    async doSave() {\n      try {\n        if (this.validateExamBank()) {\n          let data = {\n            ...this.selectedData\n          };\n          this.resumable.opts.query.param = JSON.stringify(data);\n          this.popupLoading = true;\n          switch (this.modeModal) {\n            case this.FormMode.INSERT:\n              this.resumable.opts.target = 'http://localhost:9000/api/exam-banks';\n              this.resumable.addFile(this.selectedFile);\n              break;\n            case this.FormMode.UPDATE:\n              if (JSON.stringify(this.selectedData) !== JSON.stringify(this.objSelectedData) || JSON.stringify(this.file) !== JSON.stringify(this.objFileSelected)) {\n                //update file tư liệu\n                if (this.selectedFile) {\n                  this.resumable.opts.target = 'http://localhost:9000/api/exam-banks';\n                  this.resumable.addFile(this.selectedFile);\n                } else {\n                  this.popupLoading = true;\n                  await updateExamBank(data).then(res => {\n                    this.$store.dispatch('handleSuccess', MESSAGE.HTTP_UPDATE_OK);\n                    this.loadExamBank();\n                    this.showModal();\n                  }).catch(error => {\n                    if (error.response.status === RESPONSE_STATUS.HTTP_UNPROCESSABLE_ENTITY) {\n                      for (let itemError in error.response.data.errors) {\n                        this.invalidData[itemError] = error.response.data.errors[itemError][0];\n                      }\n                    } else {\n                      this.$store.dispatch('handleServerError');\n                    }\n                  }).finally(() => {\n                    this.popupLoading = false;\n                  });\n                }\n              } else {\n                this.popupLoading = false;\n                this.showModal();\n              }\n              break;\n            default:\n              break;\n          }\n        }\n      } catch (error) {\n        this.popupLoading = false;\n        console.log(error);\n      }\n    },\n    /**\r\n     * Click nút xóa\r\n     */\n    onRowDelete() {\n      //đề thi đang được sử dụng\n      if (this.selectedData.is_exist) {\n        this.warningVisible = true;\n      }\n      //không sử dụng\n      else {\n        this.isPopupDelete = true;\n      }\n    },\n    /**\r\n     * Xử lý hàm sinh mã theo tên\r\n     */\n    handlerGenerateCode() {\n      if (this.modeGenerate) this.selectedData.exam_bank_code = generateCode({\n        value: this.selectedData.exam_bank_name\n      });\n    },\n    /**\r\n     * Validate mã phòng thi\r\n     * Ko cho phép nhập các kí tự đặc biệt\r\n     * @param {*} event\r\n     */\n    handlerInputCode(event) {\n      let pattern = /[\\W_]/g;\n      let res = event.key.match(pattern);\n      if (res) {\n        event.preventDefault();\n      }\n    },\n    /**\r\n     * Ẩn hiện action row\r\n     * @param {*} index\r\n     * @param {*} data\r\n     */\n    showActions(index, data) {\n      this.isShowActions = !this.isShowActions;\n      this.selectedData = data;\n      var position = this.$refs[`busstop${index}`].getBoundingClientRect();\n      this.top = position.y + position.height;\n      this.left = position.x - position.width / 2;\n    },\n    /**\r\n     * Load dữ liệu ngân hàng đề thi\r\n     */\n    async loadExamBank() {\n      this.isLoading = true;\n      await getExamBank().then(res => {\n        this.examBankData = res.data;\n      }).catch(error => {}).finally(() => {\n        setTimeout(() => {\n          this.isLoading = false;\n        }, 750);\n      });\n    },\n    /**\r\n     * Click nút xóa phòng thi\r\n     */\n    handlerDelete() {\n      this.isLoadingDelete = true;\n      deleteExamBank(this.selectedData.id).then(res => {\n        this.isPopupDelete = false;\n        this.$store.dispatch('handleSuccess', MESSAGE.HTTP_DELETE_OK);\n        this.loadExamBank();\n      }).catch(error => {}).finally(() => {\n        setTimeout(() => {\n          this.isLoadingDelete = false;\n        }, 300);\n      });\n    },\n    /**\r\n     * sự kiện click menu item\r\n     * @param index\r\n     */\n    activeMenuItem(index) {\n      switch (index) {\n        // click item thiết lập đề\n        case 1:\n          this.$router.push({\n            name: 'setup',\n            params: {\n              id: this.selectedData.id\n            }\n          });\n          break;\n        // click item xóa\n        case 2:\n          break;\n      }\n    },\n    /**\r\n     * Ẩn form\r\n     */\n    afterHide() {\n      this.selectedData = {\n        ...this.defaultData\n      };\n      this.file = {\n        fileName: null,\n        fileSize: null,\n        success: true\n      };\n      this.invalidData = [];\n      this.exambank = {};\n    },\n    /**\r\n     *  Validate dữ liệu\r\n     *  @return boolean\r\n     */\n    validateExamBank() {\n      let invalid = true;\n      this.invalidData = [];\n      if (this.selectedData.exam_bank_code == null || this.selectedData.exam_bank_code === '') {\n        invalid = false;\n        this.invalidData.exam_bank_code = 'Mã đề thi không được để trống';\n      } else {\n        this.invalidData.exam_bank_code = null;\n      }\n      if (this.selectedData.exam_bank_name == null || this.selectedData.exam_bank_name === '') {\n        invalid = false;\n        this.invalidData.exam_bank_name = 'Tên đề thi không được để trống';\n      } else {\n        this.invalidData.exam_bank_name = null;\n      }\n      if (!this.file.fileName) {\n        invalid = false;\n        this.invalidData.fileData = 'Vui lòng tải lên file tư liệu';\n      } else {\n        this.invalidData.fileData = null;\n      }\n      return invalid;\n    },\n    /**\r\n     * Sự kiện thay đổi file\r\n     * @param {*} ref ref input\r\n     *\r\n     */\n    onFileChange(ref) {\n      if (this.$refs[ref].files[0].type === \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\") {\n        this.selectedFile = this.$refs[ref].files[0];\n        let _size = this.selectedFile.size;\n        let fSExt = ['Bytes', 'KB', 'MB', 'GB'],\n          i = 0;\n        while (_size > 900) {\n          _size /= 1024;\n          i++;\n        }\n        this.selectedData.file_size = Math.round(_size * 100) / 100 + ' ' + fSExt[i];\n        this.selectedData.file_name = this.selectedFile.name;\n        this.file.fileSize = Math.round(_size * 100) / 100 + ' ' + fSExt[i];\n        this.file.fileName = this.selectedFile.name;\n        //kiểm tra dung lượng file\n        if (this.$refs[ref].files[0].size > 30 * 1024 * 1024) {\n          this.file.success = false;\n        } else {\n          this.file.success = true;\n        }\n      } else {\n        this.contentDialog = ' File tư liệu chỉ hỗ trợ định dạng *.docx';\n        this.dialogVisible = true;\n      }\n    },\n    /**\r\n     * Thêm file\r\n     * @param {*} file\r\n     */\n    onFileAdded(file) {\n      this.resumable.upload();\n    },\n    /**\r\n     * Tiến trình tải\r\n     * @param {*} file\r\n     */\n    onFileProgress(file) {},\n    /**\r\n     * Upload thành công\r\n     * @param {*} file\r\n     * @param {*} response\r\n     */\n    onFileSuccess(file, response) {\n      this.selectedFile = null;\n      this.resumable.removeFile(file);\n      this.popupLoading = false;\n      this.showModal();\n      let message = this.modeModal === this.FormMode.INSERT ? \"Thêm đề thi thành công\" : \"Cập nhật đề thi thành công\";\n      this.$store.dispatch('handleSuccess', message);\n      this.loadExamBank();\n    },\n    /**\r\n     * Upload thất bại\r\n     * @param {*} file\r\n     * @param {*} message\r\n     */\n    onFileError(file, response) {\n      try {\n        this.popupLoading = false;\n        this.resumable.removeFile(file);\n        response = JSON.parse(response);\n        if (response.data && response.data.errorCode === 422) {\n          for (let error in response.data.errors) {\n            this.invalidData[error] = response.data.errors[error][0];\n          }\n        } else {}\n      } catch (error) {\n        console.log(error);\n      }\n    },\n    /**\r\n     * Khởi tạo Resumable upload file\r\n     */\n    createResumable() {\n      this.resumable = new Resumable({\n        target: 'http://localhost:9000/api/exam-banks',\n        method: 'POST',\n        query: {},\n        withCredentials: true,\n        headers: {\n          'Authorization': 'Bearer ' + Auth.getToken()\n          // 'Access-Control-Allow-Credentials': true,\n        },\n        testChunks: false,\n        throttleProgressCallbacks: 1,\n        simultaneousUploads: 4\n      });\n      this.resumable.on('fileAdded', this.onFileAdded);\n      this.resumable.on('fileProgress', this.onFileProgress);\n      this.resumable.on('fileSuccess', this.onFileSuccess);\n      this.resumable.on('fileError', this.onFileError);\n    },\n    /**\r\n     * Cập nhật đề thi\r\n     */\n    onRowUpdate() {\n      //object để kiểm tra xem bản ghi có thay đối hay ko\n      this.objSelectedData = {\n        ...this.selectedData\n      };\n      this.showModal(this.FormMode.UPDATE);\n    },\n    deleteRowSelect(data) {\n      this.selectedData = {\n        ...data\n      };\n      this.isPopupDelete = true;\n    },\n    /**\r\n     *\r\n     */\n    onRowSelect(data) {\n      this.modeModal = this.FormMode.UPDATE;\n      this.objSelectedData = {\n        ...data\n      };\n      this.selectedData = {\n        ...data\n      };\n      this.file.fileSize = this.selectedData.file_size;\n      this.file.fileName = this.selectedData.file_name;\n    },\n    /**\r\n     * mở action menu\r\n     * @param event\r\n     * @param data\r\n     */\n    toggle(event, data) {\n      this.$refs.menu.toggle(event);\n      this.selectedData = {\n        ...data\n      };\n    }\n  },\n  async created() {\n    await this.loadExamBank();\n  },\n  mounted() {\n    this.createResumable();\n  }\n};","map":{"version":3,"names":["vClickOutside","InputText","ExamPopup","ExamSetup","DataTable","Menu","Auth","Dialog","Column","InputNumber","Dropdown","Skeleton","generateCode","Resumable","TheLoadingProgress","Button","deleteExamBank","getExamBank","insertExamBank","updateExamBank","MESSAGE","RESPONSE_STATUS","directives","clickOutside","directive","components","data","search","selectedData","id","exam_bank_code","exam_bank_name","file_size","file_name","objSelectedData","objFileSelected","isLoadingDelete","popupLoading","warningVisible","file","fileName","fileSize","success","actionItems","label","icon","command","activeMenuItem","defaultData","resumable","invalidData","SheetIndexReference","RowReference","fileData","modeModal","FormMode","INSERT","modeGenerate","examBankData","isShowModal","isShowActions","isLoading","isPopupDelete","objectLoading","top","left","isconfigureExam","methods","showModal","doSave","validateExamBank","opts","query","param","JSON","stringify","target","addFile","selectedFile","UPDATE","then","res","$store","dispatch","HTTP_UPDATE_OK","loadExamBank","catch","error","response","status","HTTP_UNPROCESSABLE_ENTITY","itemError","errors","finally","console","log","onRowDelete","is_exist","handlerGenerateCode","value","handlerInputCode","event","pattern","key","match","preventDefault","showActions","index","position","$refs","getBoundingClientRect","y","height","x","width","setTimeout","handlerDelete","HTTP_DELETE_OK","$router","push","name","params","afterHide","exambank","invalid","onFileChange","ref","files","type","_size","size","fSExt","i","Math","round","contentDialog","dialogVisible","onFileAdded","upload","onFileProgress","onFileSuccess","removeFile","message","onFileError","parse","errorCode","createResumable","method","withCredentials","headers","getToken","testChunks","throttleProgressCallbacks","simultaneousUploads","on","onRowUpdate","deleteRowSelect","onRowSelect","toggle","menu","created","mounted"],"sources":["E:\\khoaluan\\w-score\\vue\\src\\views\\user\\ExamList.vue"],"sourcesContent":["<template>\r\n    <div class=\"form-list flex-grow-1 d-flex\">\r\n        <div class=\"d-flex flex-column flex-grow-1\">\r\n            <div class=\"d-flex flex-row title-box\">\r\n                <div class=\"list-title flex-grow-1 text-start\">Danh sách đề thi</div>\r\n            </div>\r\n            <div class=\"d-flex flex-row toolbar-box justify-content-between\">\r\n                <div class=\"left-toolbar d-flex flex-row\">\r\n                    <div class=\"m-search_form flex-row d-flex align-items-center d-flex\">\r\n                        <InputText type=\"search\" v-model=\"search\" class=\"ms-input_search w-100\" placeholder=\"Tìm kiếm\"/>\r\n                        <div class=\"icon24 icon search-right search\"></div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"right-toolbar d-flex flex-row\">\r\n                    <Button\r\n                        @click=\"isShowModal = !isShowModal, modeGenerate = true, modeModal = FormMode.INSERT\"\r\n                        class=\"ms-btn primary d-flex justify-content-center flex-grow-1 ms-btn_search ps-3 pe-3 gap-2\">\r\n                        <div class=\"icon24 icon-add-white\"></div>\r\n                        <div class=\"fw-semibold\">Thêm đề thi</div>\r\n                    </Button>\r\n                </div>\r\n            </div>\r\n            <div class=\"box list-content flex-grow-1 flex-row\">\r\n                <DataTable paginator :rows=\"10\" :rowsPerPageOptions=\"[5, 10, 20, 50]\" class=\"flex1 flex-column\"\r\n                           :class=\"{ 'loading': isLoading }\" :loading=\"isLoading\"\r\n                           :value=\"isLoading ? Array.from({ length: 8 }, () => ({ ...objectLoading })) : examBankData\"\r\n                           currentPageReportTemplate=\"{first} to {last} of {totalRecords}\"\r\n                           paginatorTemplate=\"FirstPageLink PrevPageLink flex1 CurrentPageReport NextPageLink LastPageLink RowsPerPageDropdown\"\r\n                           @rowDblclick=\"onRowSelect($event.data), isShowModal = true\" tableStyle=\"min-width: 100%\"\r\n                           rowHover>\r\n                    <template #paginatorstart>\r\n                        <Button type=\"button\" icon=\"pi pi-refresh\" text/>\r\n                    </template>\r\n                    <template #paginatorend>\r\n                        bản ghi/trang\r\n                    </template>\r\n                    <template #empty>\r\n                        <div>\r\n                            Không có dữ liệu\r\n                        </div>\r\n                    </template>\r\n                    <Column header=\"STT\" style=\"width: 100px;\" class=\"text-center\">\r\n                        <template #body=\"slotProps\">\r\n                            <div v-if=\"!isLoading\"> {{ slotProps.index + 1 }}</div>\r\n                            <div v-else>\r\n                                <Skeleton height=\"18px\" class=\"mb-2\"></Skeleton>\r\n                            </div>\r\n                        </template>\r\n                    </Column>\r\n                    <Column field=\"exam_bank_name\" style=\"width: 30vw;\" header=\"Tên đề thi\">\r\n                        <template #body=\"{ data, field, slotProps }\">\r\n                            <div v-if=\"!isLoading\"> {{ data[field] }}</div>\r\n                            <div v-else>\r\n                                <Skeleton height=\"18px\" class=\"mb-2\"></Skeleton>\r\n                            </div>\r\n                        </template>\r\n                    </Column>\r\n                    <Column field=\"exam_bank_code\" dataKey=\"id\" header=\"Mã đề thi\">\r\n                        <template #body=\"{ data, field, slotProps }\">\r\n                            <div v-if=\"!isLoading\"> {{ data[field] }}</div>\r\n                            <div v-else>\r\n                                <Skeleton height=\"18px\" class=\"mb-2\"></Skeleton>\r\n                            </div>\r\n                        </template>\r\n                    </Column>\r\n                    <Column dataKey=\"id\" header=\"Trạng thái\" style=\"width: 200px;\">\r\n                        <template #body=\"{ data, field, slotProps }\">\r\n                            <div v-if=\"!isLoading\">\r\n                                <div class=\"d-flex status-ctn max-content\" v-if=\"data['is_exist']\"\r\n                                     style=\"background-color: rgb(229, 250, 237);\">\r\n                                    <div class=\"status-dot\" style=\"background-color: rgb(0, 200, 83);\"></div>\r\n                                    <div class=\"status-text\" style=\"color: rgb(0, 200, 83);\">Đang sử dụng</div>\r\n                                </div>\r\n                                <div class=\"d-flex status-ctn max-content\" v-else\r\n                                     style=\"background-color: rgb(254, 243, 231);\">\r\n                                    <div class=\"status-dot\" style=\"background-color: rgb(243, 141, 21);\"></div>\r\n                                    <div class=\"status-text\" style=\"color: rgb(243, 141, 21);\">Không sử dụng</div>\r\n                                </div>\r\n                            </div>\r\n                            <div v-else>\r\n                                <Skeleton height=\"18px\" class=\"mb-2\"></Skeleton>\r\n                            </div>\r\n                        </template>\r\n                    </Column>\r\n                    <Column alignFrozen=\"right\" style=\"width: 100px; text-align: center;\" frozen header=\"Thao tác\">\r\n                        <template #body=\"slotProps\">\r\n                            <div class=\"row-actions flex-row\" v-if=\"!isLoading\">\r\n                                <div class=\"item\" @click=\"onRowSelect(slotProps.data)\">\r\n                                    <div class=\"v-popover popover\">\r\n                                        <div class=\"trigger\">\r\n                                            <div class=\"icon24 edit\"></div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <Button\r\n                                    class=\"ms-btn white ms-1 rounded-circle d-flex icon-only icon-only-border justify-content-center ms-btn_search\"\r\n                                    @click=\"toggle($event, slotProps.data)\" aria-haspopup=\"true\"\r\n                                    aria-controls=\"overlay_menu\">\r\n                                    <div class=\"icon-only icon24 more\"></div>\r\n                                </Button>\r\n                                <Menu ref=\"menu\" id=\"overlay_menu\" :model=\"actionItems\" :popup=\"true\"/>\r\n                            </div>\r\n                            <div v-else>\r\n                                <Skeleton height=\"18px\" class=\"mb-2\"></Skeleton>\r\n                            </div>\r\n                        </template>\r\n                    </Column>\r\n\r\n                </DataTable>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <Dialog v-model:visible=\"isPopupDelete\" modal closeOnEscape :style=\"{ width: '25vw' }\" header=\"Xóa kì thi\">\r\n        <TheLoadingProgress v-if=\"isLoadingDelete\"/>\r\n        <div class=\"w-full flex flex-column\" style=\"line-height: 1.5;\">\r\n            <span> Bạn có chắc chắn muốn xóa đề thi <b>{{ selectedData.exam_bank_code }}</b> không?</span>\r\n        </div>\r\n        <template #footer>\r\n            <Button label=\"Không\" class=\"ms-button btn detail-button secondary\" @click=\"isPopupDelete = false\"/>\r\n            <Button label=\"Xóa phòng thi\" class=\"ms-button btn w-100 danger\" @click=\"handlerDelete\"/>\r\n        </template>\r\n    </Dialog>\r\n\r\n    <Dialog v-model:visible=\"isShowModal\" @keydown.enter.prevent=\"doSave\" modal\r\n            :header=\"modeModal == FormMode.INSERT ? 'Thêm đề thi' : 'Sửa đề thi'\" @afterHide=\"afterHide\"\r\n            :style=\"{ width: '35vw' }\" closeOnEscape>\r\n        <TheLoadingProgress v-if=\"popupLoading\"/>\r\n        <div class=\"w-full flex flex-column\">\r\n            <div class=\"form-group flex-row\">\r\n                <div class=\"flex1 mr-10\">\r\n                    <div class=\"form-group-label d-flex label-form\">\r\n                        Tên đề thi\r\n                        <span class=\"required\">*</span>\r\n                    </div>\r\n                    <div class=\"ms-input ms-editor w-100\">\r\n                        <InputText v-model=\"selectedData.exam_bank_name\"\r\n                                   :class=\"{ 'error': invalidData['exam_bank_name'] }\"\r\n                                   @input=\"handlerGenerateCode\"\r\n                                   placeholder=\"Nhập tên đề thi\"/>\r\n                        <div class=\"error-text\" v-if=\"invalidData['exam_bank_name']\">\r\n                            {{ invalidData['exam_bank_name'] }}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"flex1 mr-10\">\r\n                    <div class=\"form-group-label d-flex label-form\">\r\n                        Mã đề thi\r\n                        <span class=\"required\">*</span>\r\n                    </div>\r\n                    <div class=\"ms-input ms-editor w-100\">\r\n                        <InputText v-model=\"selectedData.exam_bank_code\"\r\n                                   :class=\"{ 'error': invalidData['exam_bank_code'] }\"\r\n                                   @keypress=\"handlerInputCode\"\r\n                                   @input=\"modeGenerate = selectedData.exam_bank_code ? false : true\"\r\n                                   placeholder=\"Nhập mã đề thi\"/>\r\n                        <div class=\"error-text\" v-if=\"invalidData['exam_bank_code']\">\r\n                            {{ invalidData['exam_bank_code'] }}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"form-group flex-row\">\r\n                <div class=\"flex1 mr-10\">\r\n                    <div class=\"form-group-label d-flex label-form\">\r\n                        File tư liệu\r\n                        <span class=\"required\">*</span>\r\n                    </div>\r\n                    <div class=\"flex-grow-1\">\r\n                        <div class=\"content-step d-flex flex-column\">\r\n                            <div class=\"upload-container flex1 flex-center\" v-if=\"!file.fileName\"\r\n                                 @click=\"$refs.fileInput.click()\">\r\n                                <div class=\"no-file d-flex\">\r\n                                    <input type=\"file\" id=\"fileInput\" ref=\"fileInput\"\r\n                                           @change=\"onFileChange('fileInput')\"\r\n                                           accept=\".docx\"\r\n                                           hidden>\r\n                                </div>\r\n                            </div>\r\n                            <div class=\"import-attachment-container flex1\" v-else>\r\n                                <div class=\"file-info d-flex\">\r\n                                    <div class=\"d-flex\">\r\n                                        <div class=\"file-icon text-left\"></div>\r\n                                        <div class=\"file-name flex text-left\">{{ file.fileName }}</div>\r\n                                    </div>\r\n                                    <div class=\"file-size text-left\"> {{ file.fileSize }}</div>\r\n                                    <div class=\"file-accepted text-left d-flex\">\r\n                                        <div class=\"icon-success\" v-if=\"file.success\"></div>\r\n                                        <div v-if=\"file.success\">Hợp lệ</div>\r\n                                        <div class=\"icon-unsuccess\" v-if=\"!file.success\"></div>\r\n                                        <div v-if=\"!file.success\">Không hợp lệ</div>\r\n                                    </div>\r\n                                    <input type=\"file\" ref=\"fileInput1\" hidden\r\n                                           @change=\"onFileChange('fileInput1')\"\r\n                                           accept=\".docx\">\r\n                                    <div class=\"change-file blue-text pointer text-left text-link\"\r\n                                         @click=\"$refs.fileInput1.click()\"> Đổi tệp khác\r\n                                    </div>\r\n                                </div>\r\n                                <div class=\"file-caution\" v-if=\"file.success\">\r\n                                    <div class=\"file-caution-img\"></div>\r\n                                    <div class=\"file-caution-center mt-20\">\r\n                                        <!--                                        Lưu ý <span style=\"color: red;\">*</span>: Bạn vui lòng chọn sheet tư-->\r\n                                        <!--                                        liệu và dòng tiêu đề-->\r\n                                        <!--                                        <br>của sheet đó.-->\r\n                                    </div>\r\n                                </div>\r\n                                <div class=\"file-error\" v-if=\"!file.success\">\r\n                                    <div class=\"file-error-title red-text\"> Lý do không hợp lệ:</div>\r\n                                    <div class=\"file-error-title red-text\">- Dung lượng quá lớn</div>\r\n                                </div>\r\n                            </div>\r\n                            <div class=\"error-text\" v-if=\"invalidData['fileData']\">\r\n                                {{ invalidData['fileData'] }}\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"ms-input ms-editor w-100\"></div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <template #footer>\r\n            <div class=\"d-flex flex-row\">\r\n                <div class=\"flex1\"></div>\r\n                <Button\r\n                    @click=\"isShowModal = false, selectedData = defaultData\"\r\n                    class=\"ms-btn secondary blue me-3 d-flex justify-content-center ms-btn_search ps-3 pe-3 gap-2\">\r\n                    <div class=\"\">Đóng</div>\r\n                </Button>\r\n                <Button @click=\"doSave\" @keyup.enter.prevent=\"doSave\"\r\n                        class=\"ms-btn primary blue d-flex justify-content-center ms-btn_search ps-3 pe-3 gap-2\">\r\n                    <div class=\"\">Lưu</div>\r\n                </Button>\r\n            </div>\r\n        </template>\r\n    </Dialog>\r\n\r\n    <Dialog v-model:visible=\"warningVisible\" modal closeOnEscape :style=\"{ width: '25vw', height: '20vh' }\"\r\n            header=\"Thông báo\">\r\n        <div class=\"w-full flex flex-column\">\r\n            <span> Đề thi <b>{{ selectedData.exam_bank_name }}</b> đang được sử dụng. Bạn không thể xóa.</span>\r\n        </div>\r\n        <template #footer>\r\n            <Button label=\"Đóng\" class=\"ms-button btn detail-button secondary\" @click=\"warningVisible = false\"/>\r\n        </template>\r\n    </Dialog>\r\n    <ExamSetup :selectedData=\"selectedData\" v-if=\"isconfigureExam\"/>\r\n</template>\r\n\r\n<script>\r\nimport vClickOutside from 'click-outside-vue3'\r\nimport InputText from 'primevue/inputtext';\r\nimport ExamPopup from '@/views/user/components/ExamPopup.vue';\r\nimport ExamSetup from '@/views/user/components/ExamSetup.vue';\r\nimport DataTable from 'primevue/datatable';\r\nimport Menu from 'primevue/menu';\r\nimport Auth from \"../../../api/utils/auth\";\r\nimport Dialog from 'primevue/dialog';\r\nimport Column from 'primevue/column';\r\nimport InputNumber from 'primevue/inputnumber';\r\nimport Dropdown from 'primevue/dropdown';\r\nimport Skeleton from 'primevue/skeleton';\r\nimport {generateCode} from '@/common/functions'\r\nimport Resumable from 'resumablejs';\r\nimport TheLoadingProgress from '@/components/LoadingProgress.vue'\r\nimport Button from 'primevue/button';\r\nimport {deleteExamBank, getExamBank, insertExamBank, updateExamBank} from '/api/exam-bank';\r\nimport {MESSAGE, RESPONSE_STATUS} from \"@/common/enums\";\r\n\r\nexport default {\r\n    directives: {\r\n        clickOutside: vClickOutside.directive\r\n    },\r\n    components: {\r\n        ExamPopup,\r\n        ExamSetup,\r\n        DataTable,\r\n        Menu,\r\n        Column,\r\n        Button,\r\n        Dropdown,\r\n        InputText,\r\n        Dialog,\r\n        InputNumber,\r\n        TheLoadingProgress,\r\n        Skeleton,\r\n    },\r\n    data() {\r\n        return {\r\n            search: null,\r\n            selectedData: {\r\n                id: null,\r\n                exam_bank_code: null,\r\n                exam_bank_name: null,\r\n                file_size: null,\r\n                file_name: null,\r\n            },\r\n\r\n            objSelectedData: {},\r\n            objFileSelected: null,\r\n\r\n            isLoadingDelete: false,\r\n            popupLoading: false,\r\n\r\n            warningVisible: false,\r\n            file: {\r\n                fileName: null,\r\n                fileSize: null,\r\n                success: true,\r\n            },\r\n            actionItems: [\r\n                {\r\n                    label: 'Thiết lập đề',\r\n                    icon: 'pi pi-refresh',\r\n                    command: () => {\r\n                        this.activeMenuItem(1)\r\n                    }\r\n                },\r\n                {\r\n                    label: 'Xóa',\r\n                    icon: 'pi pi-upload',\r\n                    command: () => {\r\n                        this.activeMenuItem(2)\r\n                    }\r\n                }\r\n            ],\r\n\r\n            defaultData: {\r\n                id: null,\r\n                exam_bank_code: null,\r\n                exam_bank_name: null,\r\n            },\r\n            resumable: null,\r\n\r\n\r\n            invalidData: {\r\n                exam_bank_code: null,\r\n                exam_bank_name: null,\r\n                SheetIndexReference: null,\r\n                RowReference: null,\r\n                fileData: null\r\n            },\r\n            modeModal: this.FormMode.INSERT,\r\n            modeGenerate: true,\r\n            examBankData: [],\r\n            isShowModal: false,\r\n            isShowActions: false,\r\n            isLoading: false,\r\n            isPopupDelete: false,\r\n            objectLoading: {},\r\n            top: 0,\r\n            left: 0,\r\n            isconfigureExam: false,\r\n        }\r\n    },\r\n    methods: {\r\n        /**\r\n         * Ẩn / hiện model thêm mới\r\n         */\r\n        showModal() {\r\n            this.isShowModal = !this.isShowModal;\r\n        },\r\n\r\n        async doSave() {\r\n            try {\r\n                if (this.validateExamBank()) {\r\n                    let data = {...this.selectedData};\r\n                    this.resumable.opts.query.param = JSON.stringify(data);\r\n                    this.popupLoading = true;\r\n                    switch (this.modeModal) {\r\n                        case this.FormMode.INSERT:\r\n                            this.resumable.opts.target = 'http://localhost:9000/api/exam-banks';\r\n                            this.resumable.addFile(this.selectedFile);\r\n                            break;\r\n                        case this.FormMode.UPDATE:\r\n                            if (JSON.stringify(this.selectedData) !== JSON.stringify(this.objSelectedData) || JSON.stringify(this.file) !== JSON.stringify(this.objFileSelected)) {\r\n                                //update file tư liệu\r\n                                if (this.selectedFile) {\r\n                                    this.resumable.opts.target = 'http://localhost:9000/api/exam-banks';\r\n                                    this.resumable.addFile(this.selectedFile);\r\n                                } else {\r\n                                    this.popupLoading = true;\r\n                                    await updateExamBank(data).then(res => {\r\n                                        this.$store.dispatch('handleSuccess', MESSAGE.HTTP_UPDATE_OK)\r\n                                        this.loadExamBank();\r\n                                        this.showModal();\r\n                                    }).catch(error => {\r\n                                        if (error.response.status === RESPONSE_STATUS.HTTP_UNPROCESSABLE_ENTITY) {\r\n                                            for (let itemError in error.response.data.errors) {\r\n                                                this.invalidData[itemError] = error.response.data.errors[itemError][0];\r\n                                            }\r\n                                        } else {\r\n                                            this.$store.dispatch('handleServerError')\r\n                                        }\r\n                                    }).finally(() => {\r\n                                        this.popupLoading = false\r\n                                    });\r\n                                }\r\n                            } else {\r\n                                this.popupLoading = false;\r\n                                this.showModal();\r\n                            }\r\n                            break;\r\n                        default:\r\n                            break;\r\n                    }\r\n                }\r\n            } catch (error) {\r\n                this.popupLoading = false;\r\n                console.log(error);\r\n            }\r\n        }\r\n        ,\r\n\r\n        /**\r\n         * Click nút xóa\r\n         */\r\n        onRowDelete() {\r\n            //đề thi đang được sử dụng\r\n            if (this.selectedData.is_exist) {\r\n                this.warningVisible = true;\r\n            }\r\n            //không sử dụng\r\n            else {\r\n                this.isPopupDelete = true;\r\n            }\r\n        }\r\n        ,\r\n\r\n        /**\r\n         * Xử lý hàm sinh mã theo tên\r\n         */\r\n        handlerGenerateCode() {\r\n            if (this.modeGenerate) this.selectedData.exam_bank_code = generateCode({value: this.selectedData.exam_bank_name});\r\n        }\r\n        ,\r\n\r\n        /**\r\n         * Validate mã phòng thi\r\n         * Ko cho phép nhập các kí tự đặc biệt\r\n         * @param {*} event\r\n         */\r\n        handlerInputCode(event) {\r\n            let pattern = /[\\W_]/g;\r\n            let res = event.key.match(pattern);\r\n            if (res) {\r\n                event.preventDefault();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Ẩn hiện action row\r\n         * @param {*} index\r\n         * @param {*} data\r\n         */\r\n        showActions(index, data) {\r\n            this.isShowActions = !this.isShowActions;\r\n            this.selectedData = data;\r\n            var position = this.$refs[`busstop${index}`].getBoundingClientRect();\r\n            this.top = position.y + position.height;\r\n            this.left = position.x - position.width / 2;\r\n        },\r\n\r\n        /**\r\n         * Load dữ liệu ngân hàng đề thi\r\n         */\r\n        async loadExamBank() {\r\n            this.isLoading = true;\r\n            await getExamBank().then(res => {\r\n                this.examBankData = res.data;\r\n            }).catch(error => {\r\n\r\n            }).finally(() => {\r\n                setTimeout(() => {\r\n                    this.isLoading = false;\r\n                }, 750);\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Click nút xóa phòng thi\r\n         */\r\n        handlerDelete() {\r\n            this.isLoadingDelete = true;\r\n            deleteExamBank(this.selectedData.id).then(res => {\r\n                this.isPopupDelete = false;\r\n                this.$store.dispatch('handleSuccess', MESSAGE.HTTP_DELETE_OK);\r\n                this.loadExamBank();\r\n            }).catch(error => {\r\n\r\n            }).finally(() => {\r\n                setTimeout(() => {\r\n                    this.isLoadingDelete = false;\r\n                }, 300);\r\n            })\r\n        },\r\n\r\n        /**\r\n         * sự kiện click menu item\r\n         * @param index\r\n         */\r\n        activeMenuItem(index) {\r\n            switch (index) {\r\n                // click item thiết lập đề\r\n                case 1:\r\n                    this.$router.push({name: 'setup', params: {id: this.selectedData.id}});\r\n                    break;\r\n                // click item xóa\r\n                case 2:\r\n                    break;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Ẩn form\r\n         */\r\n        afterHide() {\r\n            this.selectedData = {...this.defaultData};\r\n            this.file = {\r\n                fileName: null,\r\n                fileSize: null,\r\n                success: true,\r\n            };\r\n            this.invalidData = [];\r\n            this.exambank = {};\r\n        },\r\n\r\n        /**\r\n         *  Validate dữ liệu\r\n         *  @return boolean\r\n         */\r\n        validateExamBank() {\r\n            let invalid = true;\r\n            this.invalidData = [];\r\n            if (this.selectedData.exam_bank_code == null || this.selectedData.exam_bank_code === '') {\r\n                invalid = false;\r\n                this.invalidData.exam_bank_code = 'Mã đề thi không được để trống';\r\n            } else {\r\n                this.invalidData.exam_bank_code = null;\r\n            }\r\n            if (this.selectedData.exam_bank_name == null || this.selectedData.exam_bank_name === '') {\r\n                invalid = false;\r\n                this.invalidData.exam_bank_name = 'Tên đề thi không được để trống';\r\n            } else {\r\n                this.invalidData.exam_bank_name = null;\r\n            }\r\n            if (!this.file.fileName) {\r\n                invalid = false;\r\n                this.invalidData.fileData = 'Vui lòng tải lên file tư liệu';\r\n            } else {\r\n                this.invalidData.fileData = null;\r\n            }\r\n            return invalid;\r\n        },\r\n\r\n        /**\r\n         * Sự kiện thay đổi file\r\n         * @param {*} ref ref input\r\n         *\r\n         */\r\n        onFileChange(ref) {\r\n            if (this.$refs[ref].files[0].type === \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\") {\r\n                this.selectedFile = this.$refs[ref].files[0];\r\n                let _size = this.selectedFile.size;\r\n                let fSExt = ['Bytes', 'KB', 'MB', 'GB'],\r\n                    i = 0;\r\n                while (_size > 900) {\r\n                    _size /= 1024;\r\n                    i++;\r\n                }\r\n                this.selectedData.file_size = (Math.round(_size * 100) / 100) + ' ' + fSExt[i];\r\n                this.selectedData.file_name = this.selectedFile.name;\r\n\r\n                this.file.fileSize = (Math.round(_size * 100) / 100) + ' ' + fSExt[i];\r\n                this.file.fileName = this.selectedFile.name;\r\n                //kiểm tra dung lượng file\r\n                if (this.$refs[ref].files[0].size > 30 * 1024 * 1024) {\r\n                    this.file.success = false;\r\n                } else {\r\n                    this.file.success = true;\r\n                }\r\n            } else {\r\n                this.contentDialog = ' File tư liệu chỉ hỗ trợ định dạng *.docx';\r\n                this.dialogVisible = true;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Thêm file\r\n         * @param {*} file\r\n         */\r\n        onFileAdded(file) {\r\n            this.resumable.upload();\r\n        },\r\n\r\n\r\n        /**\r\n         * Tiến trình tải\r\n         * @param {*} file\r\n         */\r\n        onFileProgress(file) {\r\n        },\r\n\r\n        /**\r\n         * Upload thành công\r\n         * @param {*} file\r\n         * @param {*} response\r\n         */\r\n        onFileSuccess(file, response) {\r\n            this.selectedFile = null;\r\n            this.resumable.removeFile(file);\r\n            this.popupLoading = false;\r\n            this.showModal();\r\n            let message = this.modeModal === this.FormMode.INSERT ? \"Thêm đề thi thành công\" : \"Cập nhật đề thi thành công\";\r\n            this.$store.dispatch('handleSuccess', message);\r\n            this.loadExamBank();\r\n        },\r\n\r\n        /**\r\n         * Upload thất bại\r\n         * @param {*} file\r\n         * @param {*} message\r\n         */\r\n        onFileError(file, response) {\r\n            try {\r\n                this.popupLoading = false;\r\n                this.resumable.removeFile(file);\r\n                response = JSON.parse(response);\r\n                if (response.data && response.data.errorCode === 422) {\r\n                    for (let error in response.data.errors) {\r\n                        this.invalidData[error] = response.data.errors[error][0];\r\n                    }\r\n                } else {\r\n                }\r\n            } catch (error) {\r\n                console.log(error);\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Khởi tạo Resumable upload file\r\n         */\r\n        createResumable() {\r\n            this.resumable = new Resumable({\r\n                target: 'http://localhost:9000/api/exam-banks',\r\n                method: 'POST',\r\n                query: {},\r\n                withCredentials: true,\r\n                headers: {\r\n                    'Authorization': 'Bearer ' + Auth.getToken(),\r\n                    // 'Access-Control-Allow-Credentials': true,\r\n                },\r\n                testChunks: false,\r\n                throttleProgressCallbacks: 1,\r\n                simultaneousUploads: 4,\r\n            });\r\n            this.resumable.on('fileAdded', this.onFileAdded);\r\n            this.resumable.on('fileProgress', this.onFileProgress);\r\n            this.resumable.on('fileSuccess', this.onFileSuccess);\r\n            this.resumable.on('fileError', this.onFileError);\r\n        },\r\n\r\n        /**\r\n         * Cập nhật đề thi\r\n         */\r\n        onRowUpdate() {\r\n            //object để kiểm tra xem bản ghi có thay đối hay ko\r\n            this.objSelectedData = {...this.selectedData};\r\n\r\n            this.showModal(this.FormMode.UPDATE);\r\n        },\r\n\r\n        deleteRowSelect(data) {\r\n            this.selectedData = {...data};\r\n            this.isPopupDelete = true;\r\n        },\r\n\r\n        /**\r\n         *\r\n         */\r\n        onRowSelect(data) {\r\n            this.modeModal = this.FormMode.UPDATE;\r\n            this.objSelectedData = {...data};\r\n            this.selectedData = {...data};\r\n            this.file.fileSize = this.selectedData.file_size\r\n            this.file.fileName = this.selectedData.file_name\r\n        },\r\n        /**\r\n         * mở action menu\r\n         * @param event\r\n         * @param data\r\n         */\r\n        toggle(event, data) {\r\n            this.$refs.menu.toggle(event);\r\n            this.selectedData = {...data};\r\n        }\r\n    },\r\n    async created() {\r\n        await this.loadExamBank();\r\n    },\r\n\r\n    mounted() {\r\n        this.createResumable();\r\n    },\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.content-step {\r\n    height: 250px;\r\n\r\n    .upload-container {\r\n        border: 1px dashed #ddd;\r\n        border-radius: 4px;\r\n        display: flex;\r\n        justify-content: center;\r\n        align-items: center;\r\n        cursor: pointer;\r\n\r\n        .no-file {\r\n            background: url('@public/assets/icons/add_attachment_docs.svg') no-repeat;\r\n            width: 334px;\r\n            height: 110px;\r\n        }\r\n    }\r\n\r\n    .import-attachment-container {\r\n        border-radius: 4px;\r\n        border: 1px solid #ddd;\r\n        height: 260px;\r\n        margin-bottom: 16px;\r\n        color: #333;\r\n        cursor: pointer;\r\n\r\n        .file-info {\r\n            width: 100%;\r\n            height: 48px;\r\n            align-items: center;\r\n            padding: 0 16px;\r\n            justify-content: space-between;\r\n            border-bottom: 1px solid #ddd;\r\n\r\n            &.file-info .icon-success {\r\n                width: 16px;\r\n                height: 16px;\r\n                background: transparent url('@public/assets/icons/ic_check_green.d1ac113b.svg') no-repeat;\r\n                margin-right: 8px;\r\n            }\r\n        }\r\n\r\n        .file-caution {\r\n            width: 100%;\r\n            position: relative;\r\n            display: flex;\r\n            flex-direction: column;\r\n            align-items: center;\r\n            justify-content: center;\r\n            height: calc(100% - 48px);\r\n        }\r\n\r\n        .file-caution-img {\r\n            width: 100%;\r\n            height: calc(100% - 74px);\r\n            padding-top: 20px;\r\n            background: url('@public/assets/icons/img_import.7804e3d3.svg') no-repeat 50%;\r\n        }\r\n    }\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}