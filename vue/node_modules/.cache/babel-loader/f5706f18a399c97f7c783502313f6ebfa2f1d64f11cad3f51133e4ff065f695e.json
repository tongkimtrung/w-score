{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport InputText from 'primevue/inputtext';\nimport Button from 'primevue/button';\nimport Skeleton from 'primevue/skeleton';\nimport DataTable from 'primevue/datatable';\nimport Column from 'primevue/column';\nimport Dropdown from 'primevue/dropdown';\nimport Panel from 'primevue/panel';\nimport FileUpload from 'primevue/fileupload';\nimport Stepper from 'primevue/stepper';\nimport StepperPanel from 'primevue/stepperpanel';\nimport Resumable from 'resumablejs';\nimport Dialog from 'primevue/dialog';\nimport * as XLSX from 'xlsx';\nimport ProgressBar from 'primevue/progressbar';\nimport { FILE_TYPE, MESSAGE } from \"@/common/enums\";\nimport LoadingProgress from \"@/components/LoadingProgress.vue\";\nimport { getExamResultDetail, getExamResult } from \"../../../../api/exam-result\";\nimport { get, calculate, getDetailExamManager } from '/api/grade-master';\nimport Auth from \"../../../../api/utils/auth\";\nimport InputNumber from 'primevue/inputnumber';\nexport default {\n  computed: {\n    MESSAGE() {\n      return MESSAGE;\n    }\n  },\n  components: {\n    Button,\n    InputText,\n    Panel,\n    Skeleton,\n    DataTable,\n    Dropdown,\n    ProgressBar,\n    Column,\n    FileUpload,\n    Stepper,\n    StepperPanel,\n    LoadingProgress,\n    InputNumber,\n    Dialog\n  },\n  data() {\n    return {\n      valuesFile: [{\n        STT: 1,\n        Type: 'File danh sách thi',\n        Resource: 'Chưa có file danh sách thi. Tải lên để thực hiện chấm',\n        Empty: true,\n        FileSelected: null,\n        FileSelectedOld: null,\n        ResourcePath: null,\n        FileName: null,\n        FileType: FILE_TYPE.LIST,\n        FileAccept: '.xlsx',\n        MaxFileSize: 30 * 1024 * 1024\n      }, {\n        STT: 2,\n        Type: 'File bài thi',\n        Resource: 'Chưa có file bài thi. Tải lên để thực hiện chấm',\n        Empty: true,\n        FileSelected: null,\n        FileSelectedOld: null,\n        ResourcePath: null,\n        FileName: null,\n        FileType: FILE_TYPE.EXAM,\n        FileAccept: '.zip',\n        MaxFileSize: 800 * 1024 * 1024\n      }],\n      sheetOptions: [],\n      selectedSheet: null,\n      subjectLine: 2,\n      isNextStepper: false,\n      columnsFile: [{\n        field: 'STT',\n        header: 'STT'\n      }, {\n        field: 'Type',\n        header: 'Loại file'\n      }, {\n        field: 'Resource',\n        header: 'Tên File'\n      }],\n      isCollapsed: false,\n      isLoading: false,\n      data: [],\n      selectedCity: null,\n      examResult: [],\n      cities: [{\n        name: 'New York',\n        code: 'NY'\n      }, {\n        name: 'Rome',\n        code: 'RM'\n      }, {\n        name: 'London',\n        code: 'LDN'\n      }, {\n        name: 'Istanbul',\n        code: 'IST'\n      }, {\n        name: 'Paris',\n        code: 'PRS'\n      }],\n      headerUploadFile: 'Tải file',\n      fileSelectedOnUpload: null,\n      gradingType: false,\n      //loại chấm điểm\n      isShowGradingType: false,\n      gradingTypeVisible: false,\n      deductedPoint: 50,\n      //điểm bị trừ\n      invalidDeductedPoint: null,\n      fileSelected: null,\n      isShowPopupUploadFile: false,\n      File: null,\n      FileSuccess: false,\n      isUpload: false,\n      totalSize: 0,\n      dialogVisible: false,\n      totalSizePercent: 0,\n      activeStep: 0,\n      fileInfoResponse: [],\n      resultDetail: [],\n      visibleExamResultDetail: false,\n      selectedResult: null,\n      objCheckSelectedResult: null,\n      isLoadingComponent: false,\n      modeFile: null,\n      fileXlsxSelected: null,\n      fileZipSelected: null,\n      resumable: null,\n      progress: 0,\n      invalidData: [],\n      listExamBankForExamShift: [],\n      isDisableInfo: false,\n      visibleRefineExam: false,\n      examManager: [],\n      selectedManager: null,\n      examShift: [],\n      selectedExamShift: null,\n      department: [],\n      selectedDepartment: null\n    };\n  },\n  methods: {\n    onRowSelect(data) {\n      // console.log(data);\n    },\n    async btnEvaluator(flag) {\n      //thực hiện chấm\n      if (flag) {\n        this.gradingTypeVisible = false;\n        this.deductedPoint = 50;\n        this.isLoadingComponent = true;\n        this.isShowGradingType = false;\n        var data = this.examManager.find(_item => this.selectedManager == _item.ExamId);\n        data = JSON.parse(data.ExamShift).filter(_item => _item.ExamShiftId == this.selectedExamShift && _item.DepartmentId == this.selectedDepartment && _item.ExamShiftId == this.selectedExamShift);\n        await excuteEvaluator({\n          data: data,\n          gradingType: this.gradingType,\n          deductedPoint: this.deductedPoint\n        }).then(res => {\n          this.loadExamResult();\n        }).catch(error => {\n          console.log(error);\n        }).finally(() => {\n          setTimeout(() => {\n            this.isLoadingComponent = false;\n          }, 300);\n        });\n      }\n    },\n    /**\r\n     * Sự kiện chọn kì thi\r\n     */\n    onChangeExamManager() {\n      this.valuesFile[1].FileName = this.valuesFile[0].FileName = null;\n      this.valuesFile[1].Empty = this.valuesFile[0].Empty = true;\n      this.selectedExamShift = null;\n      //dữ liệu kì thi\n      this.selectedFirst();\n      // this.loadExamResult();\n    },\n    /**\r\n     * Sự kiện chọn ca thi\r\n     */\n    onChangeExamShift() {\n      this.department = this.selectedExamShift.departments;\n      this.selectedDepartment = null;\n      this.listExamBankForExamShift = this.selectedExamShift.exam_banks;\n    },\n    /**\r\n     * Sự kiện chọn phòng thi\r\n     */\n    async onChangeDepartment() {\n      await this.loadExamResult();\n    },\n    /**\r\n     *\r\n     * @param {*} arr\r\n     */\n    selectedFirst() {\n      try {\n        this.examShift = this.selectedManager.exam_shifts;\n        this.selectedExamShift = null;\n        this.selectedDepartment = null;\n      } catch (error) {\n        console.log(error);\n      }\n    },\n    /**\r\n     * Sự kiện kéo thả file\r\n     * @param {*} event\r\n     * @param data\r\n     */\n    drop(event, data) {\n      event.preventDefault();\n      this.$refs.file.files = event.dataTransfer.files;\n      this.onChangeFile(event, data); // Trigger the onChange event manually\n    },\n    /**\r\n     * Sự kiện kéo file vào\r\n     * @param {*} event\r\n     */\n    dragover(event) {\n      event.preventDefault();\n      // Add some visual fluff to show the user can drop its files\n      if (!event.currentTarget.classList.contains('bg-green-300')) {\n        event.currentTarget.classList.remove('bg-gray-100');\n        event.currentTarget.classList.add('bg-green-300');\n      }\n    },\n    /**\r\n     * Sự kiện kéo file ra\r\n     * @param {*} event\r\n     */\n    dragleave(event) {\n      // Clean up\n      event.currentTarget.classList.add('bg-gray-100');\n      event.currentTarget.classList.remove('bg-green-300');\n    },\n    /**\r\n     * Lấy danh sách đã phân chia đề thi\r\n     */\n    getListExam() {\n      if (this.selectedDepartment == null) {\n        this.showToast(\"Chưa chọn thông tin kì thi\", 'error');\n        return;\n      }\n      if (this.selectedManager == null) {\n        this.showToast(\"Chưa chọn thông tin kì thi\", 'error');\n        return;\n      }\n      if (this.selectedExamShift == null) {\n        this.showToast(\"Chưa chọn thông tin kì thi\", 'error');\n        return;\n      }\n      if (this.valuesFile[0].FileName == null) {\n        this.showToast(\"Chưa tải lên file danh sách thi\", 'error');\n        return;\n      }\n      this.isLoadingComponent = true;\n      //dữ liệu kì thi\n      var data = this.examManager.find(_item => this.selectedManager == _item.ExamId);\n      data = JSON.parse(data.ExamShift);\n      //dữ liệu ca thi\n      var result = data.filter(_item => _item.ExamShiftId == this.selectedExamShift);\n      //Mảng dữ liệu phòng thi\n      this.department = this.getUniqueItems(result, 'DepartmentId');\n      var index = this.department.findIndex(_item => _item.DepartmentId == this.selectedDepartment);\n      data = data.filter(_item => _item.ExamShiftId == this.selectedExamShift && _item.DepartmentId == this.selectedDepartment && _item.ExamShiftId == this.selectedExamShift);\n      exportExamList({\n        fileInfo: this.department[index],\n        exam: data\n      }).then(res => {\n        var filename = this.department.find(_item => _item.DepartmentId == this.selectedDepartment).DepartmentName;\n        const url = window.URL.createObjectURL(new Blob([res]));\n        const link = document.createElement('a');\n        link.href = url;\n        link.setAttribute('download', `Danh sách phân chia đề thi ${filename}.xlsx`);\n        document.body.appendChild(link);\n        link.click();\n      }).catch(error => {}).finally(() => {\n        setTimeout(() => {\n          this.isLoadingComponent = false;\n        }, 750);\n      });\n      console.log(this.department[index]);\n    },\n    validateExam() {\n      this.invalidData = [];\n      if (this.selectedDepartment == null) {\n        this.invalidData['department'] = 'Vui lòng chọn phòng thi';\n      }\n      if (this.selectedManager == null) {\n        this.invalidData['exam'] = 'Vui lòng chọn kì thi';\n      }\n      if (this.selectedExamShift == null) {\n        this.invalidData['exam_shift'] = 'Vui lòng chọn ca thi';\n      }\n      if (this.selectedSheet == null) {\n        this.invalidData['selectedSheet'] = 'Vui lòng chọn sheet';\n      }\n      if (this.subjectLine == null) {\n        this.invalidData['subjectLine'] = 'Vui lòng chọn dòng tiêu đề';\n      }\n      if (Object.keys(this.invalidData).length > 0) {\n        return false;\n      }\n      return true;\n    },\n    /**\r\n     * Thông tin kì thi\r\n     */\n    async loadExamManager() {\n      this.isLoading = true;\n      await getDetailExamManager().then(res => {\n        this.examManager = res.data;\n      }).catch(error => {\n        console.log(error);\n      }).finally(() => {\n        setTimeout(() => {\n          this.isLoading = false;\n        }, 300);\n      });\n    },\n    changeStepperIndex() {\n      this.uploadEvent(this.activeStep);\n    },\n    /**\r\n     * Click button tinh chỉnh đề thi\r\n     */\n    refineExam() {\n      this.visibleRefineExam = true;\n    },\n    onRowReorder(event) {\n      this.listExamBankForExamShift = event.value;\n      this.$toast.add({\n        severity: 'success',\n        summary: 'Rows Reordered',\n        life: 3000\n      });\n    },\n    /**\r\n     * Xuất kết quả\r\n     */\n    exportExamResult() {\n      if (this.selectedDepartment != null && this.selectedExamShift != null && this.selectedManager != null && this.examResult.length > 0) {\n        this.isLoadingComponent = true;\n        exportExamResult({\n          data: this.examResult\n        }).then(res => {\n          var filename = this.department.find(_item => _item.DepartmentId == this.selectedDepartment).DepartmentName;\n          const url = window.URL.createObjectURL(new Blob([res]));\n          const link = document.createElement('a');\n          link.href = url;\n          link.setAttribute('download', `Kết quả chấm ${filename}.xlsx`);\n          document.body.appendChild(link);\n          link.click();\n        }).catch(error => {\n          this.showToast(\"Đã xảy ra lỗi, vui lòng liên hệ với nhà phát triển\", 'error');\n          console.log(error);\n        }).finally(() => {\n          setTimeout(() => {\n            this.isLoadingComponent = false;\n          }, 750);\n        });\n      }\n    },\n    /**\r\n     * Sự kiện thay đổi file\r\n     */\n    onChangeFile(event, data) {\n      event.preventDefault();\n      if (this.$refs.file.files[0]) {\n        this.fileSelected = this.$refs.file.files[0];\n        this.$refs.file.value = null;\n        // kiểm tra dung lượng file\n        if (data.MaxFileSize < this.fileSelected.size) {\n          this.FileSuccess = false;\n          return;\n        }\n        this.FileSuccess = true;\n        //xlsx\n        if (data.FileType === FILE_TYPE.LIST) {\n          this.valuesFile[0].FileSelected = this.fileSelected;\n          var validExts = new Array(\".xlsx\", \".xls\");\n          var fileExt = this.fileSelected.name;\n          this.sheetOptions = [];\n          fileExt = fileExt.substring(fileExt.lastIndexOf('.'));\n          if (validExts.indexOf(fileExt) < 0) {\n            this.contentDialog = ' File danh sách thi chỉ hỗ trợ định dạng *.xlsx';\n            this.dialogVisible = true;\n            return;\n          }\n          //đọc file upload lấy ra danh sách tên các sheet\n          const reader = new FileReader();\n          reader.onload = e => {\n            /* Parse data */\n            const bstr = e.target.result;\n            const workbook = XLSX.read(bstr, {\n              type: 'binary'\n            });\n            //gán sheet mặc định là sheet đầu tiên\n            //duyệt các sheet\n            for (let index = 0; index < workbook.SheetNames.length; index++) {\n              this.sheetOptions.push({\n                sheetIndex: index,\n                sheetName: workbook.SheetNames[index]\n              });\n            }\n            this.selectedSheet = this.sheetOptions[0];\n          };\n          reader.readAsBinaryString(this.fileSelected);\n        }\n        //zip\n        else {\n          var validExts = new Array(\".zip\");\n          var fileExt = this.fileSelected.name;\n          fileExt = fileExt.substring(fileExt.lastIndexOf('.'));\n          this.valuesFile[1].FileSelected = this.fileSelected;\n          if (validExts.indexOf(fileExt) < 0) {\n            this.contentDialog = ' File bài thi chỉ hỗ trợ định dạng *.zip';\n            this.dialogVisible = true;\n            return;\n          }\n        }\n      }\n    },\n    /**\r\n     * sự kiện đối giá trị sheet danh sách\r\n     */\n    changeSheetIndex() {\n      if (this.activeStep === 0) {\n        this.valuesFile[this.activeStep].FileSelectedOld = null;\n        this.fileSelected = this.valuesFile[this.activeStep].FileSelected;\n      }\n    },\n    /**\r\n     * Click nút upload\r\n     */\n    uploadEvent(index) {\n      try {\n        if (!this.validateExam()) {\n          return;\n        }\n        if (this.valuesFile[this.activeStep].FileSelectedOld === this.valuesFile[this.activeStep].FileSelected) {\n          this.activeStep++;\n          return;\n        }\n        this.isDisable = true;\n        this.isLoading = true;\n        //tên kì thi\n        // this.resumable.opts.query.ExamName = this.examManager.find(_item => _item.ExamId == this.selectedManager).ExamName;\n        // cập nhật param\n        this.resumable.opts.query.departmentId = this.selectedDepartment.id;\n        this.resumable.opts.query.examId = this.selectedManager.id;\n        this.resumable.opts.query.examShiftId = this.selectedExamShift.id;\n        this.resumable.opts.query.fileType = this.fileSelectedOnUpload.FileType;\n        this.resumable.opts.query.subjectLine = this.subjectLine;\n        this.resumable.opts.query.sheetIndex = this.selectedSheet.sheetIndex;\n        this.resumable.opts.query.departmentName = this.selectedDepartment.department_name;\n        let listExamBank = [];\n        this.listExamBankForExamShift.forEach(item => {\n          let newItem = {\n            id: item.id,\n            exam_bank_name: item.exam_bank_name\n          };\n          listExamBank.push(newItem);\n        });\n        this.resumable.opts.query.examBanks = JSON.stringify(listExamBank);\n        this.resumable.addFile(this.fileSelected);\n      } catch (error) {\n        console.log(error);\n      }\n    },\n    /**\r\n     * click button chấm thi\r\n     */\n    calculate() {\n      this.isLoading = true;\n      this.examResult = [];\n      let params = {\n        'cakeListName': this.fileInfoResponse.cakeListName,\n        'cakeStudentName': this.fileInfoResponse.cakeStudentName,\n        'examId': this.selectedManager.id,\n        'department': this.selectedDepartment,\n        'listExamBank': this.listExamBankForExamShift,\n        'examShift': this.selectedExamShift\n      };\n      calculate(params).then(res => {\n        this.examResult = res.data;\n      }).catch(error => {\n        console.log(error);\n      }).finally(() => {\n        setTimeout(() => {\n          this.isLoading = false;\n        }, 300);\n      });\n    },\n    /**\r\n     * Lấy kết quả chấm\r\n     */\n    async loadExamResult() {\n      this.isLoading = true;\n      this.examResult = [];\n      if (this.selectedDepartment == null || this.selectedExamShift == null || this.selectedManager == null) {\n        return;\n      }\n      await getExamResult({\n        examId: this.selectedManager.id,\n        departmentId: this.selectedDepartment.id,\n        examShiftId: this.selectedExamShift.id\n      }).then(res => {\n        this.examResult = res.data;\n      }).catch(error => {\n        this.$store.dispatch('handleServerError');\n        console.log(error);\n      }).finally(() => {\n        setTimeout(() => {\n          this.isLoading = false;\n        }, 750);\n      });\n      var department = this.department.find(_department => _department.DepartmentId == this.selectedDepartment);\n      if (department != null && department.ResourcePathFileList != null) {\n        this.valuesFile[0].FileName = department.ResourcePathFileList.substring(3);\n        this.valuesFile[0].Empty = false;\n      }\n      if (department != null && department.ResourcePathFileAssignment != null) {\n        this.valuesFile[1].FileName = department.ResourcePathFileAssignment.substring(3);\n        this.valuesFile[1].Empty = false;\n      }\n    },\n    /**\r\n     * Khởi tạo Resumable upload file\r\n     */\n    createResumable() {\n      this.resumable = new Resumable({\n        target: 'http://localhost:9000/api/word/upload-file',\n        method: 'POST',\n        query: {},\n        headers: {\n          'Accept': 'application/json',\n          'Content-Disposition': 'form-data; name=\"title\"',\n          'Authorization': 'Bearer ' + Auth.getToken()\n        },\n        testChunks: false,\n        throttleProgressCallbacks: 1,\n        simultaneousUploads: 4\n      });\n      this.resumable.on('fileAdded', this.onFileAdded);\n      this.resumable.on('fileProgress', this.onFileProgress);\n      this.resumable.on('fileSuccess', this.onFileSuccess);\n      this.resumable.on('fileError', this.onFileError);\n    },\n    /**\r\n     * Thêm file\r\n     * @param {*} file\r\n     */\n    onFileAdded(file) {\n      this.progress = 0;\n      this.resumable.upload();\n    },\n    /**\r\n     *\r\n     * @param {*} file\r\n     */\n    onFileProgress(file) {\n      this.progress = Math.floor(file.progress() * 100);\n    },\n    /**\r\n     *\r\n     * @param {*} file\r\n     * @param {*} response\r\n     */\n    async onFileSuccess(file, response) {\n      this.isDisable = false;\n      this.progress = 100;\n      this.isLoading = false;\n      if (this.activeStep === 0 || this.activeStep === 1) {\n        this.valuesFile[this.activeStep].FileSelectedOld = this.fileSelected;\n      }\n      try {\n        console.log(JSON.parse(response));\n        this.fileInfoResponse = JSON.parse(response).data;\n      } catch (error) {\n        console.log(error);\n      }\n      this.activeStep++;\n      this.$store.dispatch('handleSuccess', 'Tải file thành công');\n      //cập nhật lại thông tin file trên view\n      this.resumable.removeFile(file);\n      this.fileSelected = null;\n    },\n    onFileError(file, response) {\n      this.isLoading = false;\n      this.resumable.removeFile(file);\n      if (response) {\n        try {\n          response = JSON.parse(response).data?.message;\n          this.$store.dispatch('handleError', response);\n        } catch (e) {\n          this.$store.dispatch('handleError');\n        }\n      }\n    },\n    /**\r\n     * Lấy thông tin chi tiết điểm của sinh viên\r\n     */\n    async loadExamResultDetail() {\n      this.visibleExamResultDetail = true;\n      if (JSON.stringify(this.selectedResult) !== JSON.stringify(this.objCheckSelectedResult)) {\n        this.resultDetail = [];\n        this.isLoading = true;\n        await getExamResultDetail({\n          'student_code': this.selectedResult.student_code,\n          'exam_shift_detail_id': this.selectedResult.exam_shift_detail_id\n        }).then(res => {\n          this.resultDetail = res.data;\n          console.log(res);\n        }).catch(error => {\n          this.showToast(\"Đã xảy ra lỗi, vui lòng liên hệ với nhà phát triển\");\n          console.log(error);\n        }).finally(() => {\n          setTimeout(() => {\n            this.isLoading = false;\n          }, 300);\n        });\n      }\n      this.objCheckSelectedResult = {\n        ...this.selectedResult\n      };\n    },\n    /**\r\n     * Sự kiện trước khi ẩn popup upload file\r\n     */\n    afterHideUploadFile() {\n      if (this.resumable.isUploading()) {\n        this.resumable.cancel();\n        this.showToast(\"File đang được tải lên, bạn có chắc chắn muốn thoát không?\");\n        return;\n      }\n      this.progress = 0;\n      this.fileSelectedOnUpload = null;\n      this.fileSelected = null;\n      this.isShowPopupUploadFile = false;\n      this.fileSelected = null;\n    },\n    /**\r\n     * Format file size\r\n     * @param {*} bytes Dung lượng cần format\r\n     */\n    formatSize(bytes) {\n      if (bytes === 0) return \"0 B\";\n      const k = 1024;\n      const sizes = [\"B\", \"KB\", \"MB\", \"GB\", \"TB\", \"PB\", \"EB\", \"ZB\", \"YB\"];\n      const i = Math.floor(Math.log(bytes) / Math.log(k));\n      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + \" \" + sizes[i];\n    }\n  },\n  async created() {\n    await this.loadExamManager();\n    //lấy kết quả chấm\n    await this.loadExamResult();\n  },\n  mounted() {\n    this.createResumable();\n  }\n};","map":{"version":3,"names":["InputText","Button","Skeleton","DataTable","Column","Dropdown","Panel","FileUpload","Stepper","StepperPanel","Resumable","Dialog","XLSX","ProgressBar","FILE_TYPE","MESSAGE","LoadingProgress","getExamResultDetail","getExamResult","get","calculate","getDetailExamManager","Auth","InputNumber","computed","components","data","valuesFile","STT","Type","Resource","Empty","FileSelected","FileSelectedOld","ResourcePath","FileName","FileType","LIST","FileAccept","MaxFileSize","EXAM","sheetOptions","selectedSheet","subjectLine","isNextStepper","columnsFile","field","header","isCollapsed","isLoading","selectedCity","examResult","cities","name","code","headerUploadFile","fileSelectedOnUpload","gradingType","isShowGradingType","gradingTypeVisible","deductedPoint","invalidDeductedPoint","fileSelected","isShowPopupUploadFile","File","FileSuccess","isUpload","totalSize","dialogVisible","totalSizePercent","activeStep","fileInfoResponse","resultDetail","visibleExamResultDetail","selectedResult","objCheckSelectedResult","isLoadingComponent","modeFile","fileXlsxSelected","fileZipSelected","resumable","progress","invalidData","listExamBankForExamShift","isDisableInfo","visibleRefineExam","examManager","selectedManager","examShift","selectedExamShift","department","selectedDepartment","methods","onRowSelect","btnEvaluator","flag","find","_item","ExamId","JSON","parse","ExamShift","filter","ExamShiftId","DepartmentId","excuteEvaluator","then","res","loadExamResult","catch","error","console","log","finally","setTimeout","onChangeExamManager","selectedFirst","onChangeExamShift","departments","exam_banks","onChangeDepartment","exam_shifts","drop","event","preventDefault","$refs","file","files","dataTransfer","onChangeFile","dragover","currentTarget","classList","contains","remove","add","dragleave","getListExam","showToast","result","getUniqueItems","index","findIndex","exportExamList","fileInfo","exam","filename","DepartmentName","url","window","URL","createObjectURL","Blob","link","document","createElement","href","setAttribute","body","appendChild","click","validateExam","Object","keys","length","loadExamManager","changeStepperIndex","uploadEvent","refineExam","onRowReorder","value","$toast","severity","summary","life","exportExamResult","size","validExts","Array","fileExt","substring","lastIndexOf","indexOf","contentDialog","reader","FileReader","onload","e","bstr","target","workbook","read","type","SheetNames","push","sheetIndex","sheetName","readAsBinaryString","changeSheetIndex","isDisable","opts","query","departmentId","id","examId","examShiftId","fileType","departmentName","department_name","listExamBank","forEach","item","newItem","exam_bank_name","examBanks","stringify","addFile","params","cakeListName","cakeStudentName","$store","dispatch","_department","ResourcePathFileList","ResourcePathFileAssignment","createResumable","method","headers","getToken","testChunks","throttleProgressCallbacks","simultaneousUploads","on","onFileAdded","onFileProgress","onFileSuccess","onFileError","upload","Math","floor","response","removeFile","message","loadExamResultDetail","student_code","exam_shift_detail_id","afterHideUploadFile","isUploading","cancel","formatSize","bytes","k","sizes","i","parseFloat","pow","toFixed","created","mounted"],"sources":["E:\\khoaluan\\w-score\\vue\\src\\views\\admin\\components\\GradeMaster.vue"],"sourcesContent":["<template>\r\n    <div class=\"form-list flex-grow-1 d-flex\">\r\n        <div class=\"d-flex flex-column flex-grow-1\">\r\n            <div class=\"d-flex flex-row title-box\">\r\n                <LoadingProgress v-if=\"isLoading\"/>\r\n                <div class=\"list-title flex-grow-1 text-start\">Thực hiện chấm thi</div>\r\n                <div class=\"right-toolbar d-flex flex-row\">\r\n                </div>\r\n            </div>\r\n            <div class=\"flex-grow-1 flex-row row gx-0 gap-3\">\r\n                <div class=\"col-3 left-grade\" :class=\"{'collage': isCollapsed}\">\r\n                    <div class=\"title text-start d-flex justify-content-between\">\r\n                        <div class=\"text\">Thông tin kì thi</div>\r\n                        <div class=\"btn-collapse icon-toggle icon24-only\" @click=\"isCollapsed = true\"></div>\r\n                    </div>\r\n                    <div class=\"w-100 h-100\">\r\n                        <div class=\"outer\" @click=\"isCollapsed = false\">\r\n                            <div class=\"left-grade-content_collage inner rotate\">\r\n                                <div style=\"margin: auto;\">Thông tin chấm thi</div>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"left-grade-content\">\r\n                            <div class=\"group-form_box\">\r\n                                <div class=\"d-flex\">\r\n                                    <div class=\"label\">Kì thi</div>\r\n                                    <span class=\"required\">*</span>\r\n                                </div>\r\n                                <div class=\"\">\r\n                                    <Dropdown v-model=\"selectedManager\" :options=\"examManager\"\r\n                                              optionLabel=\"exam_name\"\r\n                                              placeholder=\"Kì thi\"\r\n                                              :disabled=\"this.activeStep !== 0\"\r\n                                              :class=\"{'error': invalidData['exam']}\"\r\n                                              @change=\"onChangeExamManager\"\r\n                                              class=\"ms-category text-start\"/>\r\n                                </div>\r\n                                <div class=\"ms-error-text\" v-if=\"invalidData['exam']\">\r\n                                    {{ invalidData['exam'] }}\r\n                                </div>\r\n                            </div>\r\n                            <div class=\"group-form_box mt-3\">\r\n                                <div class=\"d-flex\">\r\n                                    <div class=\"label\">Ca thi</div>\r\n                                    <span class=\"required\">*</span>\r\n                                </div>\r\n                                <div class=\"\">\r\n                                    <Dropdown v-model=\"selectedExamShift\" :options=\"examShift\"\r\n                                              optionLabel=\"exam_shift_name\"\r\n                                              placeholder=\"Ca thi\"\r\n                                              :disabled=\"activeStep !== 0\"\r\n                                              :class=\"{'error': invalidData['exam_shift']}\"\r\n                                              @change=\"onChangeExamShift\"\r\n                                              class=\"ms-category text-start\"/>\r\n                                </div>\r\n                                <div class=\"ms-error-text\" v-if=\"invalidData['exam_shift']\">\r\n                                    {{ invalidData['exam_shift'] }}\r\n                                </div>\r\n                            </div>\r\n                            <div class=\"group-form_box mt-3\">\r\n                                <div class=\"d-flex\">\r\n                                    <div class=\"label\">Phòng thi</div>\r\n                                    <span class=\"required\">*</span>\r\n                                </div>\r\n                                <div class=\"\">\r\n                                    <Dropdown v-model=\"selectedDepartment\" :options=\"department\"\r\n                                              optionLabel=\"department_name\"\r\n                                              @change=\"onChangeDepartment\"\r\n                                              placeholder=\"Phòng thi\"\r\n                                              :disabled=\"activeStep !== 0\"\r\n                                              :class=\"{'error': invalidData['department']}\"\r\n                                              class=\"ms-category text-start\"/>\r\n                                </div>\r\n                                <div class=\"ms-error-text\" v-if=\"invalidData['department']\">\r\n                                    {{ invalidData['department'] }}\r\n                                </div>\r\n                            </div>\r\n                            <div class=\"group-form_box mt-4\">\r\n                                <div class=\"flex-grow-1 d-flex justify-content-center\">\r\n                                    <Button @click=\"refineExam\" :disabled=\"selectedExamShift == null || activeStep != 0\"\r\n                                            class=\"ms-btn secondary d-flex justify-content-center flex-grow-1 ms-btn_search ps-3 pe-3 gap-2\">\r\n                                        <div class=\"\">Tinh chỉnh đề thi</div>\r\n                                    </Button>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class=\"list-content flex1 flex-column right-grade\">\r\n                    <div class=\"content-body flex1 flex-column\">\r\n                        <div class=\"mb-20\">\r\n                            <Panel header=\"1. Thông tin file\" :collapsed=\"examResult.length > 0\" toggleable\r\n                                   class=\"customPanel flex1\" :toggle-button-props=\"{ 'aria-label': 'customPanel' }\">\r\n                                <Stepper linear :activeStep=\"activeStep\">\r\n                                    <StepperPanel header=\"File danh sách thi\">\r\n                                        <template #content=\"{ index, nextCallback }\">\r\n                                            <input type=\"file\" hidden ref=\"file\" accept=\".xlsx\" id=\"assetsFieldHandle\"\r\n                                                   @change=\"onChangeFile($event, valuesFile[0])\">\r\n                                            <div class=\"flex-grow-1 d-flex\" @dragover=\"dragover\" @dragleave=\"dragleave\"\r\n                                                 @drop=\"drop($event, valuesFile[0])\">\r\n                                                <label for=\"assetsFieldHandle\" class=\"flex-grow-1 upload-wrapper\">\r\n                                                    <div class=\"d-flex flex-grow-1\">\r\n                                                        <div\r\n                                                            class=\"upload-container flex-grow-1 d-flex justify-content-center align-items-center\"\r\n                                                            v-if=\"!this.valuesFile[0].FileSelected\">\r\n                                                            <div class=\"no-file d-flex file-xlsx\">\r\n                                                            </div>\r\n                                                        </div>\r\n                                                        <div class=\"import-attachment-container flex1\"\r\n                                                             v-if=\"this.valuesFile[0].FileSelected\">\r\n                                                            <div class=\"file-info d-flex\">\r\n                                                                <div class=\"d-flex text-truncate\">\r\n                                                                    <div class=\"file-icon text-left \"\r\n                                                                         style=\"width: 20px;\"></div>\r\n                                                                    <div class=\"file-name text-left\">\r\n                                                                        {{ this.valuesFile[0].FileSelected.name }}\r\n                                                                    </div>\r\n                                                                </div>\r\n                                                                <div class=\"file-size text-left\">\r\n                                                                    {{\r\n                                                                        formatSize(this.valuesFile[0].FileSelected.size)\r\n                                                                    }}\r\n                                                                </div>\r\n                                                                <div\r\n                                                                    class=\"file-accepted text-left d-flex justify-content-between\">\r\n                                                                    <div class=\"icon-success\" v-if=\"FileSuccess\"></div>\r\n                                                                    <div v-if=\"FileSuccess\">Hợp lệ</div>\r\n                                                                    <div class=\"icon-unsuccess\"\r\n                                                                         v-if=\"!FileSuccess\"></div>\r\n                                                                    <div v-if=\"!FileSuccess\">Không hợp lệ</div>\r\n                                                                </div>\r\n                                                                <div\r\n                                                                    class=\"change-file blue-text pointer text-left text-link mw-maxcontent justify-content-end\">\r\n                                                                    Đổi\r\n                                                                    tệp khác\r\n                                                                </div>\r\n                                                            </div>\r\n                                                            <div class=\"file-caution\" v-if=\"FileSuccess\">\r\n                                                                <div class=\"file-caution-img\">\r\n                                                                </div>\r\n                                                                <div class=\"file-caution-center mt-20 text-center\">\r\n                                                                    Lưu ý\r\n                                                                    <span data-v-6d95cd2a=\"\" data-v-30ce9692=\"\"\r\n                                                                          style=\"color: red;\">*</span>\r\n                                                                    : Bạn vui lòng chọn sheet danh sách và\r\n                                                                    <br>\r\n                                                                    dòng tiêu đề của sheet đó.\r\n                                                                </div>\r\n                                                            </div>\r\n                                                            <div class=\"file-error\" v-else>\r\n                                                                <div class=\"file-error-title red-text\"> Lý do không hợp\r\n                                                                    lệ:\r\n                                                                </div>\r\n                                                                <div class=\"file-error-title red-text\">- Dung lượng quá\r\n                                                                    lớn\r\n                                                                </div>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </label>\r\n                                            </div>\r\n                                            <div class=\"form-group flex-row mt-3\" v-if=\"valuesFile[0].FileSelected\">\r\n                                                <div class=\"flex1 mr-10\">\r\n                                                    <div class=\"form-group-label d-flex label-form\">\r\n                                                        Sheet danh sách\r\n                                                        <span class=\"required\">*</span>\r\n                                                    </div>\r\n                                                    <div class=\"ms-input ms-editor w-100\">\r\n                                                        <Dropdown v-model=\"selectedSheet\" :options=\"sheetOptions\"\r\n                                                                  optionLabel=\"sheetName\"\r\n                                                                  placeholder=\"Sheet danh sách\"\r\n                                                                  @change=\"changeSheetIndex\"\r\n                                                                  :class=\"{'error': invalidData['selectedSheet']}\"\r\n                                                                  class=\"ms-category text-start\"/>\r\n                                                        <div class=\"error-text\" v-if=\"invalidData['selectedSheet']\">\r\n                                                            {{ invalidData['selectedSheet'] }}\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </div>\r\n                                                <div class=\"flex1 mr-10\">\r\n                                                    <div class=\"form-group-label d-flex label-form\">\r\n                                                        Dòng tiêu đề\r\n                                                        <span class=\"required\">*</span>\r\n                                                    </div>\r\n                                                    <div class=\"ms-input d-flex flex-column ms-editor w-100\">\r\n                                                        <InputNumber\r\n                                                            v-model=\"subjectLine\"\r\n                                                            :class=\"{ 'error': invalidData[`subjectLine`] }\"\r\n                                                            :min=\"0\"\r\n                                                            :max=\"100\"\r\n                                                            @input=\"changeSheetIndex\"\r\n                                                            :placeholder=\"MESSAGE.INPUT_PLACEHOLDER_SETUP\"\r\n                                                            class=\"ms-point flex-grow-1\"/>\r\n                                                        <div class=\"error-text\" v-if=\"invalidData['subjectLine']\">\r\n                                                            {{ invalidData['subjectLine'] }}\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                            <div class=\"flex pt-4 justify-content-end\" v-if=\"!isNextStepper\">\r\n                                                <Button label=\"Tiếp tục\" icon=\"pi pi-arrow-right\" iconPos=\"right\"\r\n                                                        :disabled=\"!valuesFile[0].FileSelected\"\r\n                                                        @click=\"fileSelectedOnUpload = valuesFile[0], changeStepperIndex(index)\"/>\r\n                                            </div>\r\n                                        </template>\r\n                                    </StepperPanel>\r\n                                    <StepperPanel header=\"File bài thi\">\r\n                                        <template #content=\"{ prevCallback, nextCallback }\">\r\n                                            <div class=\"flex flex-column h-12rem\">\r\n                                                <input type=\"file\" hidden ref=\"file\" accept=\".zip\"\r\n                                                       id=\"assetsFieldHandle\"\r\n                                                       @change=\"onChangeFile($event, valuesFile[1])\">\r\n                                                <div class=\"flex1 d-flex\" @dragover=\"dragover\" @dragleave=\"dragleave\"\r\n                                                     @drop=\"drop($event, valuesFile[1])\">\r\n                                                    <label for=\"assetsFieldHandle\" class=\"flex1 upload-wrapper\">\r\n                                                        <div class=\"d-flex flex-grow-1\">\r\n                                                            <div\r\n                                                                class=\"upload-container flex-grow-1 d-flex justify-content-center align-items-center\"\r\n                                                                v-if=\"!valuesFile[1].FileSelected\">\r\n                                                                <div class=\"no-file d-flex file-zip\">\r\n                                                                </div>\r\n                                                            </div>\r\n                                                            <div class=\"import-attachment-container flex1\"\r\n                                                                 v-if=\"valuesFile[1].FileSelected\">\r\n                                                                <div class=\"file-info d-flex\">\r\n                                                                    <div class=\"d-flex text-truncate\">\r\n                                                                        <div class=\"file-icon text-left \"\r\n                                                                             style=\"width: 20px;\"></div>\r\n                                                                        <div class=\"file-name text-left\">\r\n                                                                            {{ valuesFile[1].FileSelected.name }}\r\n                                                                        </div>\r\n                                                                    </div>\r\n                                                                    <div class=\"file-size text-left\">\r\n                                                                        {{\r\n                                                                            formatSize(valuesFile[1].FileSelected.size)\r\n                                                                        }}\r\n                                                                    </div>\r\n                                                                    <div class=\"file-accepted text-left d-flex\">\r\n                                                                        <div class=\"icon-success\"\r\n                                                                             v-if=\"FileSuccess\"></div>\r\n                                                                        <div v-if=\"FileSuccess\">Hợp lệ</div>\r\n                                                                        <div class=\"icon-unsuccess\"\r\n                                                                             v-if=\"!FileSuccess\"></div>\r\n                                                                        <div v-if=\"!FileSuccess\">Không hợp lệ</div>\r\n                                                                    </div>\r\n                                                                    <div\r\n                                                                        class=\"change-file blue-text pointer text-left text-link mw-maxcontent\">\r\n                                                                        Đổi\r\n                                                                        tệp khác\r\n                                                                    </div>\r\n                                                                </div>\r\n                                                                <div class=\"file-caution\" v-if=\"FileSuccess\">\r\n                                                                    <div class=\"file-caution-img\">\r\n                                                                    </div>\r\n                                                                    <div class=\"file-caution-center mt-20 text-center\">\r\n                                                                        Lưu ý\r\n                                                                        <span data-v-6d95cd2a=\"\" data-v-30ce9692=\"\"\r\n                                                                              style=\"color: red;\">*</span>\r\n                                                                        : Bạn vui lòng kiểm tra lại danh sách\r\n                                                                        <br>\r\n                                                                        trước khi thực hiện chấm.\r\n                                                                    </div>\r\n                                                                </div>\r\n                                                                <div class=\"file-error\" v-else>\r\n                                                                    <div class=\"file-error-title red-text\"> Lý do không\r\n                                                                        hợp\r\n                                                                        lệ:\r\n                                                                    </div>\r\n                                                                    <div class=\"file-error-title red-text\">- Dung lượng\r\n                                                                        quá\r\n                                                                        lớn\r\n                                                                    </div>\r\n                                                                </div>\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    </label>\r\n                                                </div>\r\n                                            </div>\r\n                                            <div class=\"flex pt-4 justify-content-between\">\r\n                                                <Button label=\"Back\" severity=\"secondary\" icon=\"pi pi-arrow-left\"\r\n                                                        @click=\"prevCallback, this.activeStep= 0\"/>\r\n                                                <Button label=\"Tiếp tục\" icon=\"pi pi-arrow-right\" iconPos=\"right\"\r\n                                                        :disabled=\"!valuesFile[1].FileSelected\"\r\n                                                        @click=\"fileSelectedOnUpload = valuesFile[1], uploadEvent()\"/>\r\n                                            </div>\r\n                                        </template>\r\n                                    </StepperPanel>\r\n                                    <StepperPanel header=\"Kiểm tra thông tin\">\r\n                                        <template #content=\"{ prevCallback, nextCallback }\">\r\n                                            <div class=\"flex flex-column h-12rem\">\r\n                                                <DataTable class=\"flex1 mt-10 flex-column\"\r\n                                                           :class=\"{ 'loading': isLoading }\"\r\n                                                           :loading=\"isLoading\" table-class=\"grid-group\"\r\n                                                           :value=\"isLoading ? Array.from({ length: 8 }, () => ({ ...this.department })) : fileInfoResponse.data\"\r\n                                                           tableStyle=\"min-width: 100%\" rowHover>\r\n\r\n                                                    <Column header=\"Số báo danh\" field=\"candidateNumber\"\r\n                                                            style=\"width: 40px;\"\r\n                                                            class=\"text-center\">\r\n                                                        <template #body=\"{ data, field, slotProps }\">\r\n                                                            <div v-if=\"!isLoading\"> {{ data[field] }}</div>\r\n                                                            <div v-else>\r\n                                                                <Skeleton height=\"18px\" class=\"mb-2\"></Skeleton>\r\n                                                            </div>\r\n                                                        </template>\r\n                                                    </Column>\r\n                                                    <Column header=\"Mã sinh viên\" field=\"studentID\" style=\"width: 100px\"\r\n                                                            class=\"text-center\">\r\n                                                        <template #body=\"{ data, field, slotProps }\">\r\n                                                            <div v-if=\"!isLoading\"> {{ data[field] }}</div>\r\n                                                            <div v-else>\r\n                                                                <Skeleton height=\"18px\" class=\"mb-2\"></Skeleton>\r\n                                                            </div>\r\n                                                        </template>\r\n                                                    </Column>\r\n                                                    <Column header=\"Họ và tên\" field=\"studentName\" style=\"width: 80px;\"\r\n                                                            class=\"text-left\">\r\n                                                        <template #body=\"{ data, field, slotProps }\">\r\n                                                            <div v-if=\"!isLoading\"> {{ data[field] }}</div>\r\n                                                            <div v-else>\r\n                                                                <Skeleton height=\"18px\" class=\"mb-2\"></Skeleton>\r\n                                                            </div>\r\n                                                        </template>\r\n                                                    </Column>\r\n                                                    <Column header=\"Phòng thi\" field=\"departmentName\"\r\n                                                            style=\"width: 100px;\"\r\n                                                            class=\"text-center\">\r\n                                                        <template #body=\"{ data, field, slotProps }\">\r\n                                                            <div v-if=\"!isLoading\"> {{ data[field] }}</div>\r\n                                                            <div v-else>\r\n                                                                <Skeleton height=\"18px\" class=\"mb-2\"></Skeleton>\r\n                                                            </div>\r\n                                                        </template>\r\n                                                    </Column>\r\n                                                    <Column header=\"Đề thi\" field=\"examBankName\" style=\"width: 50px;\"\r\n                                                            class=\"text-center\">\r\n                                                        <template #body=\"{ data, field, slotProps }\">\r\n                                                            <div v-if=\"!isLoading\"> {{ data[field] }}</div>\r\n                                                            <div v-else>\r\n                                                                <Skeleton height=\"18px\" class=\"mb-2\"></Skeleton>\r\n                                                            </div>\r\n                                                        </template>\r\n                                                    </Column>\r\n                                                </DataTable>\r\n                                            </div>\r\n                                            <div class=\"flex pt-4 justify-content-between\">\r\n                                                <Button label=\"Back\" severity=\"secondary\" icon=\"pi pi-arrow-left\"\r\n                                                        @click=\"prevCallback\"/>\r\n                                                <Button label=\"Next\" icon=\"pi pi-arrow-right\" iconPos=\"right\"\r\n                                                        @click=\"nextCallback\"/>\r\n                                            </div>\r\n                                        </template>\r\n                                    </StepperPanel>\r\n                                    <StepperPanel header=\"Chấm thi\">\r\n                                        <template #content=\"{ prevCallback }\">\r\n                                            <div class=\"flex flex-column h-12rem\">\r\n                                                <div\r\n                                                    class=\"border-2 border-dashed surface-border border-round surface-ground flex-auto flex justify-content-center align-items-center font-medium\">\r\n                                                </div>\r\n                                            </div>\r\n                                            <div class=\"flex pt-4 justify-content-start\">\r\n                                                <Button label=\"Back\" severity=\"secondary\" icon=\"pi pi-arrow-left\"\r\n                                                        @click=\"prevCallback\"/>\r\n                                                <Button label=\"Chấm thi\" icon=\"pi pi-arrow-right\"\r\n                                                        @click=\"calculate\"/>\r\n                                            </div>\r\n                                        </template>\r\n                                    </StepperPanel>\r\n                                </Stepper>\r\n                            </Panel>\r\n                        </div>\r\n                        <div class=\"mb-20 flex-column flex1\">\r\n                            <Panel header=\"2. Kết quả chấm\" toggleable :collapsed=\"examResult.length == 0\"\r\n                                   class=\"customPanel flex1\" :toggle-button-props=\"{ 'aria-label': 'customPanel' }\">\r\n                                <div class=\"ms-panel-header\">\r\n                                    <div class=\"flex1\"></div>\r\n                                    <!--                                    <Button class=\"ms-button btn primary has-tooltip\" aria-label=\"Youtube\"-->\r\n                                    <!--                                            v-if=\"examResult.length != 0\" @click=\"exportExamResult\">-->\r\n                                    <!--                                        &lt;!&ndash;                                        <img alt=\"logo\"&ndash;&gt;-->\r\n                                    <!--                                        &lt;!&ndash;                                             src=\"../../../../public/assets/icon/ic_export_excel.cd7bdef7.svg\"&ndash;&gt;-->\r\n                                    <!--                                        &lt;!&ndash;                                             class=\"export-excel\" />&ndash;&gt;-->\r\n                                    <!--                                        <span class=\"px-3 text\">Xuất kết quả</span>-->\r\n                                    <!--                                    </Button>-->\r\n                                </div>\r\n                                <DataTable class=\"flex1 mt-10 flex-column\" :class=\"{ 'loading': isLoading }\"\r\n                                           :loading=\"isLoading\" table-class=\"grid-group\"\r\n                                           :value=\"isLoading ? Array.from({ length: 8 }, () => ({ ...this.department })) : examResult\"\r\n                                           tableStyle=\"min-width: 100%\" rowHover>\r\n\r\n                                    <Column header=\"STT\" style=\"width: 40px;\" class=\"text-center\">\r\n                                        <template #body=\"slotProps\">\r\n                                            <div> {{ slotProps.index + 1 }}</div>\r\n                                        </template>\r\n                                    </Column>\r\n                                    <Column header=\"Số báo danh\" field=\"candidate_number\" style=\"width: 40px;\"\r\n                                            class=\"text-center\">\r\n                                        <template #body=\"{ data, field, slotProps }\">\r\n                                            <div v-if=\"!isLoading\"> {{ data[field] }}</div>\r\n                                            <div v-else>\r\n                                                <Skeleton height=\"18px\" class=\"mb-2\"></Skeleton>\r\n                                            </div>\r\n                                        </template>\r\n                                    </Column>\r\n                                    <Column header=\"Họ và tên\" field=\"student_name\" style=\"width: 80px;\"\r\n                                            class=\"text-left\">\r\n                                        <template #body=\"{ data, field, slotProps }\">\r\n                                            <div v-if=\"!isLoading\"> {{ data[field] }}</div>\r\n                                            <div v-else>\r\n                                                <Skeleton height=\"18px\" class=\"mb-2\"></Skeleton>\r\n                                            </div>\r\n                                        </template>\r\n                                    </Column>\r\n                                    <Column header=\"Đề thi\" field=\"exam_bank_name\" style=\"width: 80px;\"\r\n                                            class=\"text-left\">\r\n                                        <template #body=\"{ data, field, slotProps }\">\r\n                                            <div v-if=\"!isLoading\"> {{ data[field] }}</div>\r\n                                            <div v-else>\r\n                                                <Skeleton height=\"18px\" class=\"mb-2\"></Skeleton>\r\n                                            </div>\r\n                                        </template>\r\n                                    </Column>\r\n                                    <Column header=\"Tổng điểm\" field=\"total\" style=\"width: 50px;\"\r\n                                            class=\"text-center\">\r\n                                        <template #body=\"{ data, field, slotProps }\">\r\n                                            <div v-if=\"!isLoading\"> {{ data[field] }}</div>\r\n                                            <div v-else>\r\n                                                <Skeleton height=\"18px\" class=\"mb-2\"></Skeleton>\r\n                                            </div>\r\n                                        </template>\r\n                                    </Column>\r\n                                    <Column alignFrozen=\"right\" style=\"width: 80px;\" frozen header=\"Thao tác\">\r\n                                        <template #body=\"slotProps\">\r\n                                            <div class=\"row-actions\" v-if=\"!isLoading\">\r\n                                                <div class=\"text-link\"\r\n                                                     @click=\"onRowSelect(slotProps.data), selectedResult = slotProps.data, loadExamResultDetail()\">\r\n                                                    <div>Xem chi tiết</div>\r\n                                                </div>\r\n                                            </div>\r\n                                            <div v-else>\r\n                                                <Skeleton height=\"18px\" class=\"mb-2\"></Skeleton>\r\n                                            </div>\r\n                                        </template>\r\n                                    </Column>\r\n                                </DataTable>\r\n                            </Panel>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <Dialog v-model:visible=\"visibleExamResultDetail\" modal\r\n            :header=\"selectedResult ? `Điểm chi tiết ${selectedResult.student_name}` : ''\" :style=\"{ width: '75vw' }\"\r\n            scrollable\r\n            closeIcon=\"close-button\">\r\n        <DataTable class=\"flex1 flex-column\" :class=\"{ 'loading': isLoading }\" :loading=\"isLoading\"\r\n                   rowGroupMode=\"rowspan\" groupRowsBy=\"parent_criteria_id\" sortMode=\"single\" sortField=\"parent_criteria_id\" :sortOrder=\"1\"\r\n                   :value=\"isLoading ? Array.from({ length: 8 }, () => ({ ...this.department })) : resultDetail\"\r\n                   tableStyle=\"min-width: 100%\" rowHover>\r\n            <Column field=\"parent_criteria_id\" header=\"Tiêu chí\" style=\"width: 100px;\">\r\n                <template #body=\"slotProps\">\r\n                    <div class=\"flex align-items-center gap-2\">\r\n                        <span>{{ slotProps.data.parent_criteria_name }}</span>\r\n                    </div>\r\n                </template>\r\n            </Column>\r\n            <Column header=\"STT\" style=\"width: 15px;\" class=\"text-left\">\r\n                <template #body=\"slotProps\">\r\n                    <div v-if=\"!isLoading\"> {{ slotProps.index + 1 }}</div>\r\n                    <div v-else>\r\n                        <Skeleton height=\"18px\" class=\"mb-2\"></Skeleton>\r\n                    </div>\r\n                </template>\r\n            </Column>\r\n            <Column header=\"Mã sinh viên\" field=\"student_code\" style=\"width: 100px;\" class=\"text-left\">\r\n                <template #body=\"{ data, field, slotProps }\">\r\n                    <div v-if=\"!isLoading\"> {{ data[field] }}</div>\r\n                    <div v-else>\r\n                        <Skeleton height=\"18px\" class=\"mb-2\"></Skeleton>\r\n                    </div>\r\n                </template>\r\n            </Column>\r\n            <Column header=\"Đề thi\" field=\"exam_bank_name\" style=\"width: 100px;\" class=\"text-left\">\r\n                <template #body=\"{ data, field, slotProps }\">\r\n                    <div v-if=\"!isLoading\"> {{ data[field] }}</div>\r\n                    <div v-else>\r\n                        <Skeleton height=\"18px\" class=\"mb-2\"></Skeleton>\r\n                    </div>\r\n                </template>\r\n            </Column>\r\n            <Column header=\"Phòng thi\" field=\"department_name\" style=\"width: 100px;\" class=\"text-left\">\r\n                <template #body=\"{ data, field, slotProps }\">\r\n                    <div v-if=\"!isLoading\"> {{ data[field] }}</div>\r\n                    <div v-else>\r\n                        <Skeleton height=\"18px\" class=\"mb-2\"></Skeleton>\r\n                    </div>\r\n                </template>\r\n            </Column>\r\n            <Column header=\"Tiêu chí\" field=\"property_name\" style=\"width: 100px;\" class=\"text-left\">\r\n                <template #body=\"{ data, field, slotProps }\">\r\n                    <div v-if=\"!isLoading\"> {{ data[field] }}</div>\r\n                    <div v-else>\r\n                        <Skeleton height=\"18px\" class=\"mb-2\"></Skeleton>\r\n                    </div>\r\n                </template>\r\n            </Column>\r\n            <Column header=\"Điểm tiêu chí\" field=\"point\" style=\"width: 100px;\" class=\"text-left\">\r\n                <template #body=\"{ data, field, slotProps }\">\r\n                    <div v-if=\"!isLoading\"> {{ data[field] }}</div>\r\n                    <div v-else>\r\n                        <Skeleton height=\"18px\" class=\"mb-2\"></Skeleton>\r\n                    </div>\r\n                </template>\r\n            </Column>\r\n            <Column header=\"Điểm đạt được\" field=\"real_point\" style=\"width: 100px;\" class=\"text-left\">\r\n                <template #body=\"{ data, field, slotProps }\">\r\n                    <div v-if=\"!isLoading\"> {{ data[field] }}</div>\r\n                    <div v-else>\r\n                        <Skeleton height=\"18px\" class=\"mb-2\"></Skeleton>\r\n                    </div>\r\n                </template>\r\n            </Column>\r\n        </DataTable>\r\n        <template #footer>\r\n            <Button label=\"Đóng\" class=\"text-white ms-button text-white btn w-100 danger\"\r\n                    @click=\"visibleExamResultDetail = false, selectedResult = null\"/>\r\n        </template>\r\n    </Dialog>\r\n\r\n    <Dialog v-model:visible=\"visibleRefineExam\" modal :style=\"{ width: '60vw' }\"\r\n            scrollable\r\n            closeIcon=\"close-button\">\r\n        <template #header>\r\n            <div class=\"inline-flex align-items-center justify-content-center gap-2\">\r\n                <span class=\"fw-bold fs-16\">Tinh chỉnh đề thi</span>\r\n                <div class=\"mt-2 fw-lighter\">Thực hiện sắp xếp đề thi tương ứng với danh sách thi</div>\r\n            </div>\r\n        </template>\r\n        <DataTable class=\"flex1 flex-column\" :class=\"{ 'loading': isLoading }\" :loading=\"isLoading\"\r\n                   table-class=\"grid-group\"\r\n                   :reorderableColumns=\"true\" @rowReorder=\"onRowReorder\"\r\n                   :value=\"listExamBankForExamShift\"\r\n                   tableStyle=\"min-width: 100%\" rowHover>\r\n            <Column rowReorder headerStyle=\"width: 1.5rem\" :reorderableColumn=\"false\"/>\r\n            <Column header=\"STT\" style=\"width: 15px;\" class=\"text-left\">\r\n                <template #body=\"slotProps\">\r\n                    <div> {{ slotProps.index + 1 }}</div>\r\n                </template>\r\n            </Column>\r\n            <Column header=\"Mã đề thi\" field=\"exam_bank_code\" style=\"width: 100px;\" class=\"text-left\">\r\n                <template #body=\"{ data, field, slotProps }\">\r\n                    <div> {{ data[field] }}</div>\r\n                </template>\r\n            </Column>\r\n            <Column header=\"Tên đề thi\" field=\"exam_bank_name\" style=\"width: 100px;\" class=\"text-left\">\r\n                <template #body=\"{ data, field, slotProps }\">\r\n                    <div> {{ data[field] }}</div>\r\n                </template>\r\n            </Column>\r\n        </DataTable>\r\n        <template #footer>\r\n            <div class=\"d-flex flex-row\">\r\n                <div class=\"flex1\"></div>\r\n                <Button\r\n                    class=\"ms-btn secondary d-flex justify-content-center ms-btn_search ps-3 pe-3 gap-2 me-2\"\r\n                    @click=\"visibleRefineExam = false\">\r\n                    <div class=\"\">Đóng</div>\r\n                </Button>\r\n            </div>\r\n        </template>\r\n    </Dialog>\r\n</template>\r\n\r\n<script>\r\nimport InputText from 'primevue/inputtext';\r\nimport Button from 'primevue/button';\r\nimport Skeleton from 'primevue/skeleton';\r\nimport DataTable from 'primevue/datatable';\r\nimport Column from 'primevue/column';\r\nimport Dropdown from 'primevue/dropdown';\r\nimport Panel from 'primevue/panel';\r\nimport FileUpload from 'primevue/fileupload';\r\nimport Stepper from 'primevue/stepper';\r\nimport StepperPanel from 'primevue/stepperpanel';\r\nimport Resumable from 'resumablejs';\r\nimport Dialog from 'primevue/dialog';\r\nimport * as XLSX from 'xlsx';\r\nimport ProgressBar from 'primevue/progressbar';\r\nimport {FILE_TYPE, MESSAGE} from \"@/common/enums\";\r\nimport LoadingProgress from \"@/components/LoadingProgress.vue\";\r\nimport {getExamResultDetail, getExamResult} from \"../../../../api/exam-result\";\r\nimport {get, calculate, getDetailExamManager} from '/api/grade-master';\r\nimport Auth from \"../../../../api/utils/auth\";\r\nimport InputNumber from 'primevue/inputnumber';\r\n\r\nexport default {\r\n    computed: {\r\n        MESSAGE() {\r\n            return MESSAGE\r\n        }\r\n    },\r\n    components: {\r\n        Button,\r\n        InputText,\r\n        Panel,\r\n        Skeleton,\r\n        DataTable,\r\n        Dropdown,\r\n        ProgressBar,\r\n        Column,\r\n        FileUpload,\r\n        Stepper,\r\n        StepperPanel,\r\n        LoadingProgress,\r\n        InputNumber,\r\n        Dialog\r\n\r\n    },\r\n    data() {\r\n        return {\r\n            valuesFile: [\r\n                {\r\n                    STT: 1,\r\n                    Type: 'File danh sách thi',\r\n                    Resource: 'Chưa có file danh sách thi. Tải lên để thực hiện chấm',\r\n                    Empty: true,\r\n                    FileSelected: null,\r\n                    FileSelectedOld: null,\r\n                    ResourcePath: null,\r\n                    FileName: null,\r\n                    FileType: FILE_TYPE.LIST,\r\n                    FileAccept: '.xlsx',\r\n                    MaxFileSize: 30 * 1024 * 1024\r\n                },\r\n                {\r\n                    STT: 2,\r\n                    Type: 'File bài thi',\r\n                    Resource: 'Chưa có file bài thi. Tải lên để thực hiện chấm',\r\n                    Empty: true,\r\n                    FileSelected: null,\r\n                    FileSelectedOld: null,\r\n                    ResourcePath: null,\r\n                    FileName: null,\r\n                    FileType: FILE_TYPE.EXAM,\r\n                    FileAccept: '.zip',\r\n                    MaxFileSize: 800 * 1024 * 1024\r\n                },\r\n            ],\r\n            sheetOptions: [],\r\n            selectedSheet: null,\r\n            subjectLine: 2,\r\n            isNextStepper: false,\r\n            columnsFile: [\r\n                {field: 'STT', header: 'STT'},\r\n                {field: 'Type', header: 'Loại file'},\r\n                {field: 'Resource', header: 'Tên File'},\r\n            ],\r\n            isCollapsed: false,\r\n            isLoading: false,\r\n            data: [],\r\n            selectedCity: null,\r\n            examResult: [],\r\n            cities: [\r\n                {name: 'New York', code: 'NY'},\r\n                {name: 'Rome', code: 'RM'},\r\n                {name: 'London', code: 'LDN'},\r\n                {name: 'Istanbul', code: 'IST'},\r\n                {name: 'Paris', code: 'PRS'}\r\n            ],\r\n            headerUploadFile: 'Tải file',\r\n            fileSelectedOnUpload: null,\r\n            gradingType: false, //loại chấm điểm\r\n            isShowGradingType: false,\r\n            gradingTypeVisible: false,\r\n            deductedPoint: 50, //điểm bị trừ\r\n            invalidDeductedPoint: null,\r\n\r\n            fileSelected: null,\r\n            isShowPopupUploadFile: false,\r\n            File: null,\r\n            FileSuccess: false,\r\n            isUpload: false,\r\n            totalSize: 0,\r\n            dialogVisible: false,\r\n            totalSizePercent: 0,\r\n            activeStep: 0,\r\n            fileInfoResponse: [],\r\n\r\n            resultDetail: [],\r\n            visibleExamResultDetail: false,\r\n            selectedResult: null,\r\n            objCheckSelectedResult: null,\r\n\r\n\r\n            isLoadingComponent: false,\r\n\r\n            modeFile: null,\r\n            fileXlsxSelected: null,\r\n            fileZipSelected: null,\r\n\r\n            resumable: null,\r\n            progress: 0,\r\n            invalidData: [],\r\n            listExamBankForExamShift: [],\r\n            isDisableInfo: false,\r\n            visibleRefineExam: false,\r\n\r\n            examManager: [],\r\n            selectedManager: null,\r\n            examShift: [],\r\n            selectedExamShift: null,\r\n            department: [],\r\n            selectedDepartment: null,\r\n\r\n        }\r\n    },\r\n    methods: {\r\n        onRowSelect(data) {\r\n            // console.log(data);\r\n        },\r\n\r\n        async btnEvaluator(flag) {\r\n            //thực hiện chấm\r\n            if (flag) {\r\n                this.gradingTypeVisible = false;\r\n                this.deductedPoint = 50;\r\n                this.isLoadingComponent = true;\r\n                this.isShowGradingType = false;\r\n                var data = this.examManager.find(_item => this.selectedManager == _item.ExamId);\r\n                data = JSON.parse(data.ExamShift).filter(_item => _item.ExamShiftId == this.selectedExamShift && _item.DepartmentId == this.selectedDepartment && _item.ExamShiftId == this.selectedExamShift);\r\n                await excuteEvaluator({\r\n                    data: data,\r\n                    gradingType: this.gradingType,\r\n                    deductedPoint: this.deductedPoint\r\n                }).then(res => {\r\n                    this.loadExamResult();\r\n                }).catch(error => {\r\n                    console.log(error);\r\n                }).finally(() => {\r\n                    setTimeout(() => {\r\n                        this.isLoadingComponent = false;\r\n                    }, 300);\r\n                });\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Sự kiện chọn kì thi\r\n         */\r\n        onChangeExamManager() {\r\n            this.valuesFile[1].FileName = this.valuesFile[0].FileName = null;\r\n            this.valuesFile[1].Empty = this.valuesFile[0].Empty = true;\r\n            this.selectedExamShift = null;\r\n            //dữ liệu kì thi\r\n            this.selectedFirst();\r\n            // this.loadExamResult();\r\n        },\r\n\r\n        /**\r\n         * Sự kiện chọn ca thi\r\n         */\r\n        onChangeExamShift() {\r\n            this.department = this.selectedExamShift.departments;\r\n            this.selectedDepartment = null;\r\n            this.listExamBankForExamShift = this.selectedExamShift.exam_banks;\r\n        },\r\n\r\n        /**\r\n         * Sự kiện chọn phòng thi\r\n         */\r\n        async onChangeDepartment() {\r\n            await this.loadExamResult()\r\n        },\r\n\r\n        /**\r\n         *\r\n         * @param {*} arr\r\n         */\r\n        selectedFirst() {\r\n            try {\r\n                this.examShift = this.selectedManager.exam_shifts;\r\n                this.selectedExamShift = null;\r\n                this.selectedDepartment = null;\r\n            } catch (error) {\r\n                console.log(error);\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Sự kiện kéo thả file\r\n         * @param {*} event\r\n         * @param data\r\n         */\r\n        drop(event, data) {\r\n            event.preventDefault();\r\n            this.$refs.file.files = event.dataTransfer.files;\r\n            this.onChangeFile(event, data); // Trigger the onChange event manually\r\n        },\r\n\r\n        /**\r\n         * Sự kiện kéo file vào\r\n         * @param {*} event\r\n         */\r\n        dragover(event) {\r\n            event.preventDefault();\r\n            // Add some visual fluff to show the user can drop its files\r\n            if (!event.currentTarget.classList.contains('bg-green-300')) {\r\n                event.currentTarget.classList.remove('bg-gray-100');\r\n                event.currentTarget.classList.add('bg-green-300');\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Sự kiện kéo file ra\r\n         * @param {*} event\r\n         */\r\n        dragleave(event) {\r\n            // Clean up\r\n            event.currentTarget.classList.add('bg-gray-100');\r\n            event.currentTarget.classList.remove('bg-green-300');\r\n        },\r\n\r\n        /**\r\n         * Lấy danh sách đã phân chia đề thi\r\n         */\r\n        getListExam() {\r\n            if (this.selectedDepartment == null) {\r\n                this.showToast(\"Chưa chọn thông tin kì thi\", 'error');\r\n                return;\r\n            }\r\n\r\n            if (this.selectedManager == null) {\r\n                this.showToast(\"Chưa chọn thông tin kì thi\", 'error');\r\n                return;\r\n            }\r\n\r\n            if (this.selectedExamShift == null) {\r\n                this.showToast(\"Chưa chọn thông tin kì thi\", 'error');\r\n                return;\r\n            }\r\n\r\n            if (this.valuesFile[0].FileName == null) {\r\n                this.showToast(\"Chưa tải lên file danh sách thi\", 'error');\r\n                return;\r\n            }\r\n\r\n            this.isLoadingComponent = true;\r\n            //dữ liệu kì thi\r\n            var data = this.examManager.find(_item => this.selectedManager == _item.ExamId);\r\n            data = JSON.parse(data.ExamShift);\r\n            //dữ liệu ca thi\r\n            var result = data.filter(_item => _item.ExamShiftId == this.selectedExamShift);\r\n            //Mảng dữ liệu phòng thi\r\n            this.department = this.getUniqueItems(result, 'DepartmentId');\r\n\r\n            var index = this.department.findIndex(_item => _item.DepartmentId == this.selectedDepartment);\r\n            data = data.filter(_item => _item.ExamShiftId == this.selectedExamShift && _item.DepartmentId == this.selectedDepartment && _item.ExamShiftId == this.selectedExamShift);\r\n            exportExamList({fileInfo: this.department[index], exam: data}).then(res => {\r\n                var filename = this.department.find(_item => _item.DepartmentId == this.selectedDepartment).DepartmentName;\r\n                const url = window.URL.createObjectURL(new Blob([res]));\r\n                const link = document.createElement('a');\r\n                link.href = url;\r\n                link.setAttribute('download', `Danh sách phân chia đề thi ${filename}.xlsx`);\r\n                document.body.appendChild(link);\r\n                link.click();\r\n            }).catch(error => {\r\n\r\n            }).finally(() => {\r\n                setTimeout(() => {\r\n                    this.isLoadingComponent = false;\r\n                }, 750);\r\n            });\r\n\r\n            console.log(this.department[index]);\r\n\r\n        },\r\n\r\n        validateExam() {\r\n            this.invalidData = [];\r\n            if (this.selectedDepartment == null) {\r\n                this.invalidData['department'] = 'Vui lòng chọn phòng thi';\r\n            }\r\n\r\n            if (this.selectedManager == null) {\r\n                this.invalidData['exam'] = 'Vui lòng chọn kì thi';\r\n            }\r\n\r\n            if (this.selectedExamShift == null) {\r\n                this.invalidData['exam_shift'] = 'Vui lòng chọn ca thi';\r\n            }\r\n            if (this.selectedSheet == null) {\r\n                this.invalidData['selectedSheet'] = 'Vui lòng chọn sheet';\r\n            }\r\n            if (this.subjectLine == null) {\r\n                this.invalidData['subjectLine'] = 'Vui lòng chọn dòng tiêu đề';\r\n            }\r\n            if (Object.keys(this.invalidData).length > 0) {\r\n                return false;\r\n            }\r\n            return true;\r\n        },\r\n\r\n        /**\r\n         * Thông tin kì thi\r\n         */\r\n        async loadExamManager() {\r\n            this.isLoading = true;\r\n            await getDetailExamManager().then(res => {\r\n                this.examManager = res.data;\r\n            }).catch(error => {\r\n                console.log(error);\r\n            }).finally(() => {\r\n                setTimeout(() => {\r\n                    this.isLoading = false;\r\n                }, 300);\r\n            })\r\n        },\r\n\r\n        changeStepperIndex() {\r\n            this.uploadEvent(this.activeStep);\r\n        },\r\n\r\n        /**\r\n         * Click button tinh chỉnh đề thi\r\n         */\r\n        refineExam() {\r\n            this.visibleRefineExam = true;\r\n        },\r\n\r\n        onRowReorder(event) {\r\n            this.listExamBankForExamShift = event.value;\r\n            this.$toast.add({severity: 'success', summary: 'Rows Reordered', life: 3000});\r\n        },\r\n\r\n        /**\r\n         * Xuất kết quả\r\n         */\r\n        exportExamResult() {\r\n            if (this.selectedDepartment != null && this.selectedExamShift != null && this.selectedManager != null && this.examResult.length > 0) {\r\n                this.isLoadingComponent = true;\r\n                exportExamResult({data: this.examResult}).then(res => {\r\n                    var filename = this.department.find(_item => _item.DepartmentId == this.selectedDepartment).DepartmentName;\r\n                    const url = window.URL.createObjectURL(new Blob([res]));\r\n                    const link = document.createElement('a');\r\n                    link.href = url;\r\n                    link.setAttribute('download', `Kết quả chấm ${filename}.xlsx`);\r\n                    document.body.appendChild(link);\r\n                    link.click();\r\n                }).catch(error => {\r\n                    this.showToast(\"Đã xảy ra lỗi, vui lòng liên hệ với nhà phát triển\", 'error');\r\n                    console.log(error);\r\n                }).finally(() => {\r\n                    setTimeout(() => {\r\n                        this.isLoadingComponent = false;\r\n                    }, 750);\r\n                });\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Sự kiện thay đổi file\r\n         */\r\n        onChangeFile(event, data) {\r\n            event.preventDefault();\r\n            if (this.$refs.file.files[0]) {\r\n                this.fileSelected = this.$refs.file.files[0];\r\n                this.$refs.file.value = null;\r\n                // kiểm tra dung lượng file\r\n                if (data.MaxFileSize < this.fileSelected.size) {\r\n                    this.FileSuccess = false;\r\n                    return;\r\n                }\r\n                this.FileSuccess = true;\r\n                //xlsx\r\n                if (data.FileType === FILE_TYPE.LIST) {\r\n                    this.valuesFile[0].FileSelected = this.fileSelected;\r\n                    var validExts = new Array(\".xlsx\", \".xls\");\r\n                    var fileExt = this.fileSelected.name;\r\n                    this.sheetOptions = [];\r\n                    fileExt = fileExt.substring(fileExt.lastIndexOf('.'));\r\n                    if (validExts.indexOf(fileExt) < 0) {\r\n                        this.contentDialog = ' File danh sách thi chỉ hỗ trợ định dạng *.xlsx';\r\n                        this.dialogVisible = true;\r\n                        return;\r\n                    }\r\n                    //đọc file upload lấy ra danh sách tên các sheet\r\n                    const reader = new FileReader();\r\n                    reader.onload = (e) => {\r\n                        /* Parse data */\r\n                        const bstr = e.target.result;\r\n                        const workbook = XLSX.read(bstr, {type: 'binary'});\r\n                        //gán sheet mặc định là sheet đầu tiên\r\n                        //duyệt các sheet\r\n                        for (let index = 0; index < workbook.SheetNames.length; index++) {\r\n                            this.sheetOptions.push({\r\n                                sheetIndex: index,\r\n                                sheetName: workbook.SheetNames[index]\r\n                            });\r\n                        }\r\n                        this.selectedSheet = this.sheetOptions[0];\r\n                    }\r\n                    reader.readAsBinaryString(this.fileSelected);\r\n                }\r\n                //zip\r\n                else {\r\n                    var validExts = new Array(\".zip\");\r\n                    var fileExt = this.fileSelected.name;\r\n                    fileExt = fileExt.substring(fileExt.lastIndexOf('.'));\r\n                    this.valuesFile[1].FileSelected = this.fileSelected;\r\n                    if (validExts.indexOf(fileExt) < 0) {\r\n                        this.contentDialog = ' File bài thi chỉ hỗ trợ định dạng *.zip';\r\n                        this.dialogVisible = true;\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * sự kiện đối giá trị sheet danh sách\r\n         */\r\n        changeSheetIndex() {\r\n            if (this.activeStep === 0) {\r\n                this.valuesFile[this.activeStep].FileSelectedOld = null;\r\n                this.fileSelected = this.valuesFile[this.activeStep].FileSelected;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Click nút upload\r\n         */\r\n        uploadEvent(index) {\r\n            try {\r\n                if (!this.validateExam()) {\r\n                    return;\r\n                }\r\n                if (this.valuesFile[this.activeStep].FileSelectedOld === this.valuesFile[this.activeStep].FileSelected) {\r\n                    this.activeStep++;\r\n                    return;\r\n                }\r\n                this.isDisable = true;\r\n                this.isLoading = true;\r\n                //tên kì thi\r\n                // this.resumable.opts.query.ExamName = this.examManager.find(_item => _item.ExamId == this.selectedManager).ExamName;\r\n                // cập nhật param\r\n                this.resumable.opts.query.departmentId = this.selectedDepartment.id;\r\n                this.resumable.opts.query.examId = this.selectedManager.id;\r\n                this.resumable.opts.query.examShiftId = this.selectedExamShift.id;\r\n                this.resumable.opts.query.fileType = this.fileSelectedOnUpload.FileType;\r\n                this.resumable.opts.query.subjectLine = this.subjectLine;\r\n                this.resumable.opts.query.sheetIndex = this.selectedSheet.sheetIndex;\r\n                this.resumable.opts.query.departmentName = this.selectedDepartment.department_name;\r\n                let listExamBank = [];\r\n                this.listExamBankForExamShift.forEach(item => {\r\n                    let newItem = {\r\n                        id: item.id,\r\n                        exam_bank_name: item.exam_bank_name\r\n                    };\r\n                    listExamBank.push(newItem);\r\n                });\r\n                this.resumable.opts.query.examBanks = JSON.stringify(listExamBank);\r\n                this.resumable.addFile(this.fileSelected);\r\n            } catch (error) {\r\n                console.log(error)\r\n            }\r\n        },\r\n\r\n        /**\r\n         * click button chấm thi\r\n         */\r\n        calculate() {\r\n            this.isLoading = true;\r\n            this.examResult = [];\r\n            let params = {\r\n                'cakeListName': this.fileInfoResponse.cakeListName,\r\n                'cakeStudentName': this.fileInfoResponse.cakeStudentName,\r\n                'examId': this.selectedManager.id,\r\n                'department': this.selectedDepartment,\r\n                'listExamBank': this.listExamBankForExamShift,\r\n                'examShift': this.selectedExamShift,\r\n            }\r\n            calculate(params).then(res => {\r\n                this.examResult = res.data;\r\n            }).catch(error => {\r\n                console.log(error)\r\n            }).finally(() => {\r\n                setTimeout(() => {\r\n                    this.isLoading = false;\r\n                }, 300);\r\n            })\r\n        },\r\n\r\n        /**\r\n         * Lấy kết quả chấm\r\n         */\r\n        async loadExamResult() {\r\n            this.isLoading = true;\r\n            this.examResult = [];\r\n            if (this.selectedDepartment == null || this.selectedExamShift == null || this.selectedManager == null) {\r\n                return;\r\n            }\r\n            await getExamResult({\r\n                examId: this.selectedManager.id,\r\n                departmentId: this.selectedDepartment.id,\r\n                examShiftId: this.selectedExamShift.id\r\n            }).then(res => {\r\n                this.examResult = res.data;\r\n            }).catch(error => {\r\n                this.$store.dispatch('handleServerError');\r\n                console.log(error);\r\n            }).finally(() => {\r\n                setTimeout(() => {\r\n                    this.isLoading = false;\r\n                }, 750);\r\n            });\r\n            var department = this.department.find(_department => _department.DepartmentId == this.selectedDepartment);\r\n\r\n            if (department != null && department.ResourcePathFileList != null) {\r\n                this.valuesFile[0].FileName = department.ResourcePathFileList.substring(3);\r\n                this.valuesFile[0].Empty = false;\r\n            }\r\n\r\n            if (department != null && department.ResourcePathFileAssignment != null) {\r\n                this.valuesFile[1].FileName = department.ResourcePathFileAssignment.substring(3);\r\n                this.valuesFile[1].Empty = false;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Khởi tạo Resumable upload file\r\n         */\r\n        createResumable() {\r\n            this.resumable = new Resumable({\r\n                target: 'http://localhost:9000/api/word/upload-file',\r\n                method: 'POST',\r\n                query: {},\r\n                headers: {\r\n                    'Accept': 'application/json',\r\n                    'Content-Disposition': 'form-data; name=\"title\"',\r\n                    'Authorization': 'Bearer ' + Auth.getToken()\r\n                },\r\n                testChunks: false,\r\n                throttleProgressCallbacks: 1,\r\n                simultaneousUploads: 4,\r\n            });\r\n            this.resumable.on('fileAdded', this.onFileAdded);\r\n            this.resumable.on('fileProgress', this.onFileProgress);\r\n            this.resumable.on('fileSuccess', this.onFileSuccess);\r\n            this.resumable.on('fileError', this.onFileError);\r\n        },\r\n\r\n        /**\r\n         * Thêm file\r\n         * @param {*} file\r\n         */\r\n        onFileAdded(file) {\r\n            this.progress = 0;\r\n            this.resumable.upload();\r\n        },\r\n\r\n        /**\r\n         *\r\n         * @param {*} file\r\n         */\r\n        onFileProgress(file) {\r\n            this.progress = Math.floor(file.progress() * 100);\r\n        },\r\n\r\n        /**\r\n         *\r\n         * @param {*} file\r\n         * @param {*} response\r\n         */\r\n        async onFileSuccess(file, response) {\r\n            this.isDisable = false;\r\n            this.progress = 100;\r\n            this.isLoading = false;\r\n            if (this.activeStep === 0 || this.activeStep === 1) {\r\n                this.valuesFile[this.activeStep].FileSelectedOld = this.fileSelected;\r\n            }\r\n            try {\r\n                console.log(JSON.parse(response))\r\n                this.fileInfoResponse = JSON.parse(response).data;\r\n            } catch (error) {\r\n                console.log(error)\r\n            }\r\n            this.activeStep++;\r\n            this.$store.dispatch('handleSuccess', 'Tải file thành công');\r\n            //cập nhật lại thông tin file trên view\r\n            this.resumable.removeFile(file);\r\n            this.fileSelected = null\r\n\r\n        },\r\n\r\n        onFileError(file, response) {\r\n            this.isLoading = false;\r\n            this.resumable.removeFile(file);\r\n            if (response) {\r\n                try {\r\n                    response = JSON.parse(response).data?.message\r\n                    this.$store.dispatch('handleError', response)\r\n                } catch (e) {\r\n                    this.$store.dispatch('handleError')\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Lấy thông tin chi tiết điểm của sinh viên\r\n         */\r\n        async loadExamResultDetail() {\r\n            this.visibleExamResultDetail = true;\r\n            if (JSON.stringify(this.selectedResult) !== JSON.stringify(this.objCheckSelectedResult)) {\r\n                this.resultDetail = [];\r\n                this.isLoading = true;\r\n                await getExamResultDetail({\r\n                    'student_code': this.selectedResult.student_code,\r\n                    'exam_shift_detail_id': this.selectedResult.exam_shift_detail_id\r\n                }).then(res => {\r\n                    this.resultDetail = res.data;\r\n                    console.log(res);\r\n                }).catch(error => {\r\n                    this.showToast(\"Đã xảy ra lỗi, vui lòng liên hệ với nhà phát triển\");\r\n                    console.log(error);\r\n                }).finally(() => {\r\n                    setTimeout(() => {\r\n                        this.isLoading = false;\r\n                    }, 300);\r\n                })\r\n            }\r\n            this.objCheckSelectedResult = {...this.selectedResult}\r\n        },\r\n\r\n        /**\r\n         * Sự kiện trước khi ẩn popup upload file\r\n         */\r\n        afterHideUploadFile() {\r\n            if (this.resumable.isUploading()) {\r\n                this.resumable.cancel();\r\n                this.showToast(\"File đang được tải lên, bạn có chắc chắn muốn thoát không?\");\r\n                return;\r\n            }\r\n            this.progress = 0;\r\n            this.fileSelectedOnUpload = null;\r\n            this.fileSelected = null;\r\n            this.isShowPopupUploadFile = false;\r\n            this.fileSelected = null\r\n        },\r\n\r\n        /**\r\n         * Format file size\r\n         * @param {*} bytes Dung lượng cần format\r\n         */\r\n        formatSize(bytes) {\r\n            if (bytes === 0) return \"0 B\";\r\n            const k = 1024;\r\n            const sizes = [\"B\", \"KB\", \"MB\", \"GB\", \"TB\", \"PB\", \"EB\", \"ZB\", \"YB\"];\r\n            const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + \" \" + sizes[i];\r\n        },\r\n    },\r\n    async created() {\r\n        await this.loadExamManager();\r\n        //lấy kết quả chấm\r\n        await this.loadExamResult();\r\n    },\r\n\r\n    mounted() {\r\n        this.createResumable();\r\n    },\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.left-grade {\r\n\r\n    background: #fff;\r\n    border: 1px solid rgb(221, 221, 221);\r\n    border-bottom-right-radius: 4px;\r\n    border-top-right-radius: 4px;\r\n    height: 100%;\r\n\r\n    .title {\r\n        height: 50px;\r\n        width: 100%;\r\n        padding: 18px 12px 15px 15px;\r\n        align-items: center;\r\n        border-bottom: 1px solid rgb(221, 221, 221);\r\n\r\n        .text {\r\n            font-weight: 600;\r\n        }\r\n\r\n        .btn-collapse {\r\n            cursor: pointer;\r\n            transform: rotate(0deg);\r\n            transition-duration: 0.4s;\r\n        }\r\n    }\r\n\r\n    .outer {\r\n        position: relative;\r\n        display: none;\r\n        width: 100%;\r\n        cursor: pointer;\r\n        margin: auto;\r\n\r\n        .inner {\r\n            width: 100vh;\r\n            height: 45px;\r\n            font-size: 16px;\r\n            font-weight: 600;\r\n            position: absolute;\r\n            display: flex;\r\n            left: 50%;\r\n            top: 36vh;\r\n        }\r\n\r\n        .rotate {\r\n            transform: translateX(-50%) translateY(-50%) rotate(-90deg);\r\n        }\r\n    }\r\n\r\n    &.collage {\r\n        width: 56px;\r\n\r\n        .title {\r\n            .text {\r\n                display: none;\r\n            }\r\n\r\n            .btn-collapse {\r\n                transform: rotate(180deg);\r\n            }\r\n        }\r\n\r\n        .left-grade-content {\r\n            display: none;\r\n        }\r\n\r\n        .outer {\r\n            position: relative;\r\n            display: inline-block;\r\n            width: 100%;\r\n            cursor: pointer;\r\n            margin: auto;\r\n        }\r\n    }\r\n\r\n    .left-grade-content {\r\n        overflow: auto;\r\n        height: 100%;\r\n        padding: 16px;\r\n    }\r\n}\r\n\r\n.right-grade {\r\n    border: 1px solid rgb(221, 221, 221);\r\n    border-radius: 4px;\r\n    background: #fff;\r\n\r\n    .p-panel-header {\r\n        background: #fff !important;\r\n        border: none !important;\r\n    }\r\n\r\n    .p-panel.customPanel .p-panel-header .p-panel-title {\r\n        font-size: 16px;\r\n        font-weight: 700;\r\n    }\r\n\r\n    button.p-panel-toggler[aria-label='customPanel'] span {\r\n        width: max-content;\r\n        display: flex;\r\n        align-items: center;\r\n    }\r\n\r\n    button.p-panel-toggler[aria-label='customPanel'] span::before {\r\n        margin-right: 4px;\r\n        content: \"\";\r\n        height: 16px !important;\r\n        width: 16px !important;\r\n    }\r\n\r\n\r\n    button.p-panel-toggler[aria-label='customPanel'] span::after {\r\n        width: max-content;\r\n        color: #2979ff !important;\r\n        cursor: pointer;\r\n        border: none !important;\r\n        font-weight: 400 !important;\r\n        font-size: 14px;\r\n    }\r\n\r\n\r\n    .upload-container .info-file {\r\n        padding: 20px;\r\n    }\r\n\r\n    .info-file .icon-zip {\r\n        width: 40px;\r\n        height: 40px;\r\n        background: url('@public/assets/icons/zip.svg') no-repeat;\r\n        margin-right: 10px;\r\n        background-position: center;\r\n        background-size: 100%;\r\n    }\r\n\r\n    .left-box {\r\n        width: 202px;\r\n        margin-right: 18px;\r\n        height: 100%;\r\n    }\r\n\r\n    .box,\r\n    .card {\r\n        background-color: #fff;\r\n        border-radius: 4px;\r\n        box-shadow: 0 0 11px rgba(0, 0, 0, .08);\r\n    }\r\n\r\n    .list-tab-menu {\r\n        padding: 25px 8px 0;\r\n        overflow: auto;\r\n        height: 100%;\r\n        color: #707070;\r\n    }\r\n\r\n    .p-panel {\r\n        &.customPanel {\r\n            .p-panel-content {\r\n                border: unset;\r\n            }\r\n        }\r\n    }\r\n\r\n    .tab-item {\r\n        margin-bottom: 15px;\r\n        cursor: pointer;\r\n    }\r\n\r\n    .list-tab-menu .tab-item-parent.active {\r\n        font-weight: 600;\r\n        color: #ff6d00;\r\n    }\r\n\r\n    .list-tab-menu .tab-item-parent:hover {\r\n        border-radius: 4px;\r\n        background-color: #fbe9e7;\r\n        color: #ff6d00;\r\n    }\r\n\r\n    .grid-nodata-content {\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        height: 100%;\r\n        width: 100%;\r\n        background-color: #fff;\r\n        border-radius: 4px;\r\n    }\r\n\r\n    .grid-nodata-content .img-nodata {\r\n        background-image: url('@public/assets/icons/ic_empty_grid.681d1e47.svg');\r\n        height: 160px;\r\n        width: 260px;\r\n        background-position: 50%;\r\n    }\r\n\r\n    .description-nodata {\r\n        text-align: center;\r\n        font-size: 14px;\r\n        color: #182d4b;\r\n        padding-bottom: 8px;\r\n    }\r\n\r\n    .grid-nodata-content .description-nodata {\r\n        color: #9e9fab;\r\n        padding-bottom: 8px;\r\n    }\r\n\r\n    .list-tab-menu .tab-item-parent {\r\n        height: 36px;\r\n        padding-left: 10px;\r\n        padding-bottom: 10px;\r\n        padding-top: 10px;\r\n    }\r\n\r\n    .content-body {\r\n        padding: 17px 20px 12px 16px;\r\n        overflow: auto;\r\n    }\r\n\r\n    .content-body .title-1 {\r\n        font-size: 16px;\r\n        font-weight: 700;\r\n        margin-bottom: 15px;\r\n        line-height: 26px;\r\n        align-items: center;\r\n    }\r\n\r\n    .content-body .title-2 {\r\n        font-size: 14px;\r\n        font-weight: 700;\r\n        line-height: 19px;\r\n    }\r\n\r\n    /* .content-footer {\r\n        background-color: #fbfbfe;\r\n        padding: 12px 24px;\r\n    } */\r\n    .p-button-label {\r\n        padding: 0 16px;\r\n    }\r\n\r\n    .tab-item-child {\r\n        padding: 10px 0 0px 20px;\r\n    }\r\n\r\n    .tab-item .tab-item-child:not(:first-child) {\r\n        padding-top: 0;\r\n    }\r\n\r\n    .box.left-box {\r\n        width: 13vw;\r\n    }\r\n\r\n    .p-button .export-excel {\r\n        display: inline-block;\r\n        margin: -7px 7px -7px 12px;\r\n    }\r\n\r\n    .export-excel {\r\n        width: 20px;\r\n        height: 20px;\r\n    }\r\n\r\n\r\n    .p-button .export-excel ~ .text {\r\n        padding-right: 16px;\r\n        padding-left: 0;\r\n    }\r\n\r\n    .customPanel.p-panel.p-panel-toggleable .p-panel-header {\r\n        padding: 0px 14px 14px 0 !important;\r\n    }\r\n\r\n    .upload-container .no-file.file-xlsx {\r\n        background: url('@public/assets/icons/add_attachment.c604b695.svg') no-repeat;\r\n        width: 334px;\r\n        height: 110px;\r\n        margin-top: 20px;\r\n        background-size: contain;\r\n        background-position: center;\r\n        margin-bottom: 20px;\r\n    }\r\n\r\n    .upload-wrapper {\r\n        border: 1px dashed #ddd;\r\n        border-radius: 4px;\r\n        display: flex;\r\n        height: 329px;\r\n        justify-content: center;\r\n    }\r\n\r\n    .import-attachment-container {\r\n        border-radius: 4px;\r\n        height: 329px;\r\n        cursor: pointer;\r\n\r\n        .file-info {\r\n            width: 100%;\r\n            height: 48px;\r\n            align-items: center;\r\n            padding: 0 16px;\r\n            border-bottom: 1px dashed #ddd;\r\n\r\n            .file-icon {\r\n                width: 16px;\r\n                height: 16px;\r\n                background: transparent url('@public/assets/icons/ic_file_gray.84c03213.svg') no-repeat -2px 0;\r\n                margin-right: 8px;\r\n            }\r\n\r\n            .file-name, .main-content .file-info .file-size {\r\n                text-overflow: ellipsis;\r\n                padding-right: 16px;\r\n                overflow: hidden;\r\n                white-space: nowrap;\r\n            }\r\n\r\n            .file-size {\r\n                width: 95px;\r\n                text-overflow: ellipsis;\r\n                padding-right: 16px;\r\n                overflow: hidden;\r\n                white-space: nowrap;\r\n            }\r\n\r\n            .file-accepted {\r\n                padding-right: 16px;\r\n                white-space: nowrap;\r\n            }\r\n\r\n            .icon-success {\r\n                width: 16px;\r\n                height: 16px;\r\n                background: transparent url('@public/assets/icons/ic_check_green.d1ac113b.svg') no-repeat;\r\n                margin-right: 8px;\r\n            }\r\n\r\n            .icon-unsuccess {\r\n                width: 16px;\r\n                height: 16px;\r\n                background: transparent url('@public/assets/icons/ic_warning_red.68e15434.svg') no-repeat;\r\n                margin-right: 8px;\r\n            }\r\n\r\n            .change-file {\r\n                width: 100px;\r\n                overflow: hidden;\r\n                white-space: nowrap;\r\n\r\n                &.text-link {\r\n                    color: #2979ff !important;\r\n                    cursor: pointer;\r\n                    border: none !important;\r\n                    font-weight: 400 !important;\r\n                }\r\n            }\r\n        }\r\n\r\n        .file-error {\r\n            .red-text {\r\n                color: #ef5350;\r\n            }\r\n        }\r\n\r\n        .file-caution {\r\n            width: 100%;\r\n            height: calc(100% - 48px);\r\n        }\r\n\r\n        .file-caution-img {\r\n            width: 100%;\r\n            height: calc(100% - 74px);\r\n            background: url('@public/assets/icons/img_import.7804e3d3.svg') no-repeat 50%;\r\n        }\r\n    }\r\n\r\n    .file-zip {\r\n        background: url('@public/assets/icons/upload-zip.svg') no-repeat;\r\n        width: 334px;\r\n        height: 110px;\r\n        margin-top: 20px;\r\n        background-size: contain;\r\n        background-position: center;\r\n        margin-bottom: 20px;\r\n    }\r\n}\r\n\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}